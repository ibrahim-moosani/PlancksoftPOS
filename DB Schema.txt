/*    ==Scripting Parameters==

    Source Server Version : SQL Server 2022 (16.0.1050)
    Source Database Engine Edition : Microsoft SQL Server Enterprise Edition
    Source Database Engine Type : Standalone SQL Server

    Target Server Version : SQL Server 2022
    Target Database Engine Edition : Microsoft SQL Server Enterprise Edition
    Target Database Engine Type : Standalone SQL Server
*/

USE [PlancksoftPOS]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Absence]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[Absence](
	[id] [int] IDENTITY(1,1) NOT NULL,
	[emp_id] [int] NOT NULL,
	[date] [date] NOT NULL,
	[hours] [int] NULL
) ON [PRIMARY]
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[BillItems]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[BillItems](
	[bill_id] [nvarchar](255) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	[item_barcode] [nvarchar](255) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	[item_quantity] [int] NOT NULL
) ON [PRIMARY]
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Bills]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[Bills](
	[id] [int] IDENTITY(1,1) NOT NULL,
	[cashierName] [nvarchar](255) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	[totalAmount] [decimal](18, 2) NOT NULL,
	[paidAmount] [decimal](18, 2) NOT NULL,
	[remainderAmount] [decimal](18, 2) NOT NULL,
	[date] [date] NULL,
	[ported] [int] NULL,
	[paymentByCash] [int] NULL,
	[unpaid] [int] NOT NULL,
	[postponed_bill_id] [int] NULL,
	[ClientID] [int] NULL,
	[payment_progress] [decimal](18, 2) NULL
) ON [PRIMARY]
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ClientsItems]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[ClientsItems](
	[Client_id] [int] NOT NULL,
	[item_barcode] [int] NOT NULL,
	[item_price] [decimal](18, 2) NULL
) ON [PRIMARY]
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ClientsVendors]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[ClientsVendors](
	[id] [int] IDENTITY(1,1) NOT NULL,
	[ClientName] [nvarchar](255) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	[vendor] [int] NOT NULL,
	[ClientPhone] [nvarchar](255) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	[ClientAddress] [nvarchar](255) COLLATE SQL_Latin1_General_CP1_CI_AS NULL
) ON [PRIMARY]
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Deductions]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[Deductions](
	[id] [int] IDENTITY(1,1) NOT NULL,
	[emp_id] [int] NOT NULL,
	[deduction] [decimal](18, 2) NOT NULL,
	[date] [date] NOT NULL
) ON [PRIMARY]
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Discounts]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[Discounts](
	[id] [int] IDENTITY(1,1) NOT NULL,
	[item_barcode] [nvarchar](255) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	[sale_rate] [int] NOT NULL,
	[start_date] [datetime] NULL,
	[end_date] [datetime] NULL,
	[quantity_end] [int] NULL
) ON [PRIMARY]
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Employees]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[Employees](
	[id] [int] IDENTITY(1,1) NOT NULL,
	[name] [nvarchar](255) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	[salary] [decimal](18, 2) NULL,
	[phone] [nvarchar](255) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	[address] [nvarchar](255) COLLATE SQL_Latin1_General_CP1_CI_AS NULL
) ON [PRIMARY]
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Expenses]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[Expenses](
	[id] [int] IDENTITY(1,1) NOT NULL,
	[name] [nvarchar](255) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	[cost] [decimal](18, 2) NOT NULL,
	[employee_id] [nvarchar](255) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	[date] [datetime] NULL
) ON [PRIMARY]
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[FavoriteCategories]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[FavoriteCategories](
	[id] [int] IDENTITY(1,1) NOT NULL,
	[name] [nvarchar](255) COLLATE SQL_Latin1_General_CP1_CI_AS NULL
) ON [PRIMARY]
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Items]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[Items](
	[id] [int] IDENTITY(1,1) NOT NULL,
	[ItemName] [nvarchar](255) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	[ItemBarCode] [nvarchar](255) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	[ItemQuantity] [int] NOT NULL,
	[ItemPrice] [decimal](18, 2) NOT NULL,
	[ItemPriceTax] [decimal](18, 2) NOT NULL,
	[Favorite] [int] NULL,
	[Date] [date] NULL,
	[ItemBuyPrice] [decimal](18, 2) NULL,
	[Picture] [varbinary](max) NULL,
	[Warehouse_id] [int] NULL,
	[ItemType] [int] NULL,
	[QuantityWarning] [int] NULL,
	[ProductionDate] [date] NULL,
	[ExpirationDate] [date] NULL,
	[EntryDate] [date] NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ItemTypes]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[ItemTypes](
	[id] [int] IDENTITY(1,1) NOT NULL,
	[name] [nvarchar](255) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL
) ON [PRIMARY]
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[LoginLogout]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[LoginLogout](
	[id] [int] IDENTITY(1,1) NOT NULL,
	[cashierName] [nvarchar](255) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	[date] [datetime] NULL,
	[action] [nvarchar](255) COLLATE SQL_Latin1_General_CP1_CI_AS NULL
) ON [PRIMARY]
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[PrinterItemType]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[PrinterItemType](
	[id] [int] IDENTITY(1,1) NOT NULL,
	[printerID] [int] NOT NULL,
	[itemTypeID] [int] NOT NULL
) ON [PRIMARY]
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Printers]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[Printers](
	[id] [int] IDENTITY(1,1) NOT NULL,
	[machineName] [nvarchar](255) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	[printerName] [nvarchar](255) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL
) ON [PRIMARY]
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RegisterHistory]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[RegisterHistory](
	[id] [int] IDENTITY(1,1) NOT NULL,
	[cashier_name] [nvarchar](255) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	[date] [datetime] NULL,
	[openorclose] [int] NULL,
	[moneyInRegister] [decimal](18, 2) NULL
) ON [PRIMARY]
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Settings]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[Settings](
	[id] [int] IDENTITY(1,1) NOT NULL,
	[SystemName] [nvarchar](255) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	[SystemLogo] [varbinary](max) NULL,
	[SystemPhone] [nvarchar](255) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	[SystemReceiptBlankSpaces] [int] NOT NULL,
	[SystemIncludeLogoInReceipt] [int] NOT NULL,
	[SystemTax] [decimal](18, 2) NOT NULL,
	[SystemAddress] [nvarchar](255) COLLATE SQL_Latin1_General_CP1_CI_AS NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[TransactionItems]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[TransactionItems](
	[id] [int] IDENTITY(1,1) NOT NULL,
	[item_barcode] [nvarchar](255) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	[item_quantity] [int] NOT NULL,
	[transaction_id] [int] NOT NULL
) ON [PRIMARY]
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Transactions]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[Transactions](
	[id] [int] IDENTITY(1,1) NOT NULL,
	[cashierName] [nvarchar](255) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	[type] [int] NOT NULL,
	[date] [date] NOT NULL,
	[time] [time](7) NULL
) ON [PRIMARY]
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[UserPermissions]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[UserPermissions](
	[user_id] [int] NOT NULL,
	[Client_card_perm] [int] NOT NULL,
	[discount_perm] [int] NOT NULL,
	[price_edit_perm] [int] NOT NULL,
	[receipt_edit_perm] [int] NOT NULL,
	[inventory_edit_perm] [int] NOT NULL,
	[expense_add_perm] [int] NOT NULL,
	[users_edit_perm] [int] NOT NULL,
	[settings_edit_perm] [int] NOT NULL,
	[personnel_edit_perm] [int] NOT NULL,
	[openclose_edit_perm] [int] NOT NULL,
	[sell_edit_perm] [int] NOT NULL
) ON [PRIMARY]
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Users]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[Users](
	[id] [int] IDENTITY(1,1) NOT NULL,
	[cashierName] [nvarchar](255) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	[UID] [nvarchar](255) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	[PWD] [nvarchar](255) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	[Authority] [int] NULL,
 CONSTRAINT [PK_Users] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VendorBillItems]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VendorBillItems](
	[bill_id] [nvarchar](255) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	[item_barcode] [nvarchar](255) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	[item_quantity] [int] NOT NULL
) ON [PRIMARY]
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[VendorBills]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[VendorBills](
	[id] [int] IDENTITY(1,1) NOT NULL,
	[cashierName] [nvarchar](255) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
	[totalAmount] [decimal](18, 2) NOT NULL,
	[date] [date] NULL,
	[unpaid] [int] NULL
) ON [PRIMARY]
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Warehouses]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[Warehouses](
	[id] [int] IDENTITY(1,1) NOT NULL,
	[name] [nvarchar](255) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL
) ON [PRIMARY]
END
GO
SET IDENTITY_INSERT [dbo].[PrinterItemType] ON 
GO
INSERT [dbo].[PrinterItemType] ([id], [printerID], [itemTypeID]) VALUES (1020, 1011, 1)
GO
SET IDENTITY_INSERT [dbo].[PrinterItemType] OFF
GO
SET IDENTITY_INSERT [dbo].[Printers] ON 
GO
INSERT [dbo].[Printers] ([id], [machineName], [printerName]) VALUES (1011, N'DESKTOP-PG2PCRV', N'Microsoft Print to PDF')
GO
SET IDENTITY_INSERT [dbo].[Printers] OFF
GO
SET IDENTITY_INSERT [dbo].[Settings] ON 
GO
INSERT [dbo].[Settings] ([id], [SystemName], [SystemLogo], [SystemPhone], [SystemReceiptBlankSpaces], [SystemIncludeLogoInReceipt], [SystemTax], [SystemAddress]) VALUES (1, N'Plancksoft', 0x89504E470D0A1A0A0000000D49484452000001880000005908060000002456B318000000017352474200AECE1CE90000000467414D410000B18F0BFC6105000000097048597300000B1300000B1301009A9C180000254149444154785EED9D7B9415D59DEFEB34202666FEB86BDD95F9237F65ADBBEE4C2623DECC9AC7BD416762343A59664C40C51790A85161255141681004FAF008A02034CAAB79360D34AF6E5E021AE333042182134445C167D4186762CC8C13933866D5FD7DABBBBAF7D9F5AD5DBB76D539A7B56BAFF559CADEBFFDDDBFBD77D5EF57A7FA9C2ACFF7FD82828282828208B4B2A0A0A0A0A08056161414141414D0CA8282828282025A595050505050402B0B0A0A0A0A0A6865414141414101AD2C2828282828A095050505050505B43289A214A5CEA524FC0FE17CC24001ED45294A510C85C5761D5A9984A17C5E6027AD0BD0C2899EE5648F0B223660FC3C0A0216D3CF4A1AFFD2EECB97045371995396F5FC73E13261B1F01301076112B0833DFAA1BF6BC15AB0F9D8807562C5F5B8745DC370BFC609B384C708BB84B2709D00DB38DFAB51B0C61817E3C30FDDB7F502DA8609799D97FDBEB0D8AE432B93D0CA3F0AEDC21B827A82E6094E761C2437087F2198CA1061B97042605A69C09C3037CC316D192D3C2930DDBC30F997755FDE170E08970A61C93AA734EB395498249C1498565AA0033DE82615CC1973C71A30AD3460BDB06E791D97B66B78893057C8B25FE80B0D68E559C2BD755DE3700DAE143E27D896B3848B85B824992718A316E324011F3067CCBDA2B0D8AE432B9350CA6441DDB85AF1B680934D3F70C708CC3E0F3057DBB242601AD544F52FEF7D9927E43DA7B8F544F0582BB03E79D121C40558CC95F5E98BE86BF84561BA80F383D967019AD0B649B0AC204021F13E2C307D577E2F20592425B16AADCBC78597858B849EC262BB0EAD4CA2BBE004531DA817C784F00A8DB5E789CD95EF0F05D6B716C0BFBEB22F36A8EB8900728FC0ECAA0512917A058A00C6ECFA325843AC1D02E09FBAEBAA0DD60DC9C8B6605D11A098569E20F9B004F680C0ECFB233D4982C5761D5A99447741D65607AE37B82A64F57982399B0AAE6258BF5A01FFFADABE9808D713076D2D0208E35D618480205B2F1FB2F0A8500FBF918C6E124C65B050ED4F838C46212C489CCCA6BF826325B8DDC462BB0EAD4C42CA99D0EFA79CE9BD2EE706A3EB7E2DEB53108FDB6DC1F32EF2BDC9F3A2305B3B1054587D8119DC9263E57F0B2F08AC4F2DD822A0F4E7DB4A7104B7E3586CD7A1954948B910FA11465CCF4F5A17A0C5C648435C10B1217EFC0B69720071DFB061FA5949B33E69F765EC24AEA3C2FA99C8BA9F7396F95EE741DF3BF4AA2F6B9D0CEC608F7E4CCF16AC059B8F0D4C0FB81E9719D670F4F0DBFDA9DF5BEACF1ABFCE5F33FF9108CB671F08DAC6DF707760CB340CE0168E5A901CF0B701661B61F8C53706E3627CF8A1FBD63C7D67D036F6DA26FF822F5F463562286E2D7170214B63BB0EAD4C420ABE72A60ED8C5C61FF9DE6B7272E6CD4FE564DF7FCCF716B7759D5C6C6CC62439A9989E0D980BD3C4DC5F9364A0D3F5755C66CFF5B312EF5F94B4FB72EA03AEA3C2FA9948E36F08F61AFDE00FD3B405FD3B2459B804581C7B4CD306A607701C33FB24D08FE9C580A0BB7CF603FEDE352F3A81BED060DA84F0938455724052689EBECBEF5C71828E6DA26DD1214976CBD2268B1E30A735F31FAD2A180373646DB584CD5FC0852C8DED3AB43209293C41B4FDC82FBDF2A7EAF3E3E7BB823FF341456C687F0B3017AA297397764F470ABECB1DB51F3389EA67E6E02BD1B1E270D8176FB6F9CA9BF53161584F4ECB4EBFF4C2EFA89633A297D60FAC33D5B280E9011CBFCC3E09EF5CBB8BA3F1DF5DE06FB9EF180DAE2E74AE3CE1CF942B78369606FE967358ABAB20089A773D4AC771A179C62EFF9CBF1C4AC78A0373615A798231460F9F40DB6A099B7F372516DB75686512527882D82081E8E58F6A86B75DAE0A991F218D9220483F1B3017AA8904F1F2479E8E147EDB2D830F26BC23BF8C8E1587C3BE787BE5131BD3EA86F5316158CF4A10049F90A04C34F222583BCB609BC517AA27944E4AE223F626BC87E4A28868A92050AEB9EB317FEFDA5355014907019E8DDD0DFEE0CFEA0366DEBE9EEA66A573E5B3FED891653A26A35A7EA8608C204190B65AC2E6DF4D1D1244EB83BE775A0EE65AF2B8E14A7AE25CDEC706CC856962EEA72521E8D4634DD8780C171F9E93AB6DA615C2FA98885FCF5E864AD03E2CC19BF5CF1BCCEF268BBFB5E0F862FD6D607A33E59319B34D62A1F9F6129243DBE22725289CAE2A1D2DCFFAE36F5C487D30B1B86937D5CB135BBFBA1204D7C88B20415C3691B6D51236FF6EEA9020D6491078510EE65A8371993F132441307B1BE23431F7172521E874FD62316A5FCD35B9B1313A1EC3D58726C36D26666F227E3D7B3924C981F5AD16C77ED39594982F218F4A82607D6D607ABBE49319B34D22C1CF0DCD87FD3DEB4ED78CE1FF7C13F583B1B8690FD5A806364962E68456DA374F300612046BAB256CFEDDD42141AC952070520EE67A309CFC01F2764910CCD606CC45D7EBA22CED5E84AE9FB547ED1F9600C3F4F300F36363EAB8EECB4EC36D26666F227E3DBBA8D7B1B33FE1D64D96FD637A4F495262B626127C0C02DEFA976ACA86E623D4179D293F5841FB578B8E55CFFBC3BF6E4E5EB558AF20415C2E0982B4D51236FF6EEA902056CB49FE9C1CD0F560D34FA2FE8C9300CA6C6DC05C74BD2ECAD2EE45F0BC9F2B36BD3C2157C54C3F0FE27DACC4755FFED5709B89D99B30F93A4C923BEB532B709C30BFC0439220581F1B74AD1BE4131FB34B627EFCEDA5215F38D7EF58FDBCBFA7F5E59A33FCEB37539F422E187A455D7C5BBDF009EA4FC8CC891B68BF3CC118A32F6FA46DB584CDBF9B3A248816090227E480AE074FBE1BF5E73639F199AD0D988BAED74559DABD0A64B195F64A98765EB491A4C8C8B22FD7C7DCC662B626E2D7D3F7B61FE57D6A05C6677E81072541B03E36E85AD82F6697C4FF8BBFBD34EEE67BFC3D1B2418D481F9776EA73E852C9E793FED570BB02ECC2730B3511204E993271863F4159220485B2D61F3EFA60E0962A50481E3FF5D3F747F6E9504C1EC6CC05C74BD2ECAD2EE55D0F5F8E6A8EDFF95139B69E7C501E301D04B967D698D4942CCD644DC7A665DA3AD12DCA10D3F9FFA2F6E9304FA31DF00D698F5B141D73A281731CCCEC4AEE7A23A0A8B66DDEFEF6E7BA52EAC5E14FF2DC2217F75AEBF63ED0BB45F2D30F9566E6CA37DF204638CBA62126DAB256CFEDDD421412C9713F56939A85D6897131DFD3BE584382C272CB349E216ED5601FECDEC6C802FAA562F6569F72AE87A7E7ED436CBF836609DD8B83A59F6E509F2C90C305B1371EB396529B7B7E19ECE4AAD2CEBAD1F3B21FB2441307B1B549D6F5EC76D9298BDA15247A375E9510904AFA666D1EC7D12C4CF0B34A6DCD6426D92D8B12EFE7BF6E3C62CA67D6C9837BD23F00DC04FBDDD96AF9E3782FA569EB491DAE709C61835020982B7D70A36FF6EEA9020963EE07B47E5A076E1FBCA09FA0F5FF3BD1FBDC5ED4CA81A00FF667636602EAA562F6569F72AE87AD949D476969CDC4C3B4FD8B83A59F6058C26B799989D89B8F5CCE21B8E135D8FD9D9B0404B36217B2541307B1B541DE8339B24D81C15766F7C2D353BD69FEA490E21AB16FF94DA26A16AA82C9AB39FDA27D1BEEA44850EFC6476368C1BBBB8422BA43C591204B1CF138C316AC464DA564BD8FCBBA94382B8574EF6231FBAF1BD1F566A35CA9525B333715747A50634999D0D988BAAD54B59DABD0AAAB11EB6E8EBC6C8EAC72AF2473F6667226E3DB73DCBED93F8C9FB5CEF805C5830FB24E2FCDB2D0982D9DBA0EAB8F885B5513508BB37BD9E9A45730E4474E6CDE8A4B6497CF5BC2B235A6055F3216A9F04FAE95A3B5A4F53DB24CA933745B400EA99BD0DADCB8E053E26316E6CB33FEC92B1B44D65F3EA67E93836D8F8C2E62FD4E9511BCD72921D9203DB85B15AA0FB3BB97262762630BEAA014D666783AED54B59DABD0ABADE7617B56D7D8A6B9BD8F726AF8F63A2245236B64A967D010FFD3AAAC9EC4CC4AD67E74BDC3E09F4EBCB7A20D4703996C10CF3EDA55157DEE1EFDAFC8BD494EFD81CD1421DB34D023EE85A60FB8697A87D12CCB7554B9EA4B6492C5DC09F45E43A5710375F57EAE44B7D1ED6575AF4805F3AF8A113DE98E89530B33322E357688826B5B341D7EAA52CED9E8A14FA1B88D28E97B8B689B47DE2FDEC21CBBE8478D74CACD424364662FC745A2320FDFAB49ED0A333AD95B627E1FDADF9F6D2A8AB2441B4BF919AA629D1208C3A669B047CD0B500B3B581F9B6EADEC3D43609F4D3B580EB5C41DC7C5DA9932F557FDC374F100B0FF80D8F7FE88477533441303B1318BF424334999D0D11AD5ECAD2EEA948F9ADD2DE43E9C7EF536D13A5A58FD3FA384A6D95F76C1959F625A434A7F2F61DB33111B79E2E6B044ADB6202BAD433FB244ABBE4935B8E7AA04743F688B59BB0D9D751574DF1776D7933354D53DB235AA863B649C0075D0B305B1B986F2DF71DA1B649A09FAE055CE70AE2E6EB4A1D7CA9C90B837882B85B02D1237F74A274234910C4CE04C657FB4393D9D9A06B2994A5DD0B9112FB1B88502B0DA97D6E8FB935A290655F7AE878A34293DA18885B4F666B45CCBC514FED2DA88ADEDF7C8DB625519AD21AF14567E4D59220B6BE959A96A5D1C0D934750BB54D023EE85A80D9DA003F742DF8CB6C9360F304AE730571F375A50EBED4E495A33C41CC3FE00FF8F11F9D28DD104D10CCCE04C657FB4393D9D9A06B2994A5DD0B91421FF35D1A3191EA9A68D8FE8693CF6C7C952CFBA2E25D7C5D8F266B3711B79ECCD686864DFC3933A867F6365443AF74CB7DB42D092416DD179D91574FF5776EFB656AB66D7AD51FF2D7FF54A1D574E7566A9B047C507580AB5F007EE87A2DCB7E466D6DD0B580EB5C019B6F166AE80B3E39F424071416DB7568651252688268987BC01FF8E01F9D285D3F27A2C7EC4C607CB53F34999D0DBA964259DABD1029F431DF2E630F683BED97AE9848DB4C785F3207932CFBA2D23063478F266B3711B79ECCD606AC15D3433DB3B7A11A7A0D12DC589B8986D5C9B797C0C86B24106F7FDB89B9B3F746B49AA66D4DCDF95FB9BA4227D46263DA004D5DAF65D953D4D6065D0B600C666B03E6C63463C03BD7F1F7C990884D957C51C7C443442F1682DB4A6A61B15D8756262185278839FBFD8107FEE044E93B2441103B13185FED0F4D666783AEA55096762F04FF56DA7A70598B86858F057D599B09B6762A59F6A582CDBDB79968BB81B8F564B6360C581F9320A49ED9DB500DBD81BBFF83B6996898B83EE2471C3B77FCCA99C98DF6E3A461E4B577D2F16C98317D5B446FE5F2A3D4D6065D0B600C666B03E6C63413982CD03851255FF0C3DDC4C262BB0EAD4C420A9DEC8059FBFD33EEFF8313A56F47831CB33381F1D5FED0647636E85A0A6569F742A4D0C77CBBAC4538266B33D17067EF953D23CBBEE8942EFC4EA0C9DA4CC4AD27B3B56160CCCB5050CFEC6DC85BCFF5F8F3CEB990FAC2D8BAE5177E67C73BCEDCBBE4A7FED9677F856ABB82C0C5C6B261C6F4E8F39D56AE38466D6DD0B500C660B636382608109320AAE24B1F4D1033F7FB83F6FCC189D2E8688260762630BEDA1F9ACCCE065D4BA12CED5E8814FAD171E0EA5354D744C3B8AE2BBA41EDEFD0F6380CBE0664D9179D86295D27306B3311E723B3B501EBCBF45CD63D246FBD01F31FA3F526062E7B86FA21E07E66A47EE5CAA7FDCE4E091819D8B8F1257FE4C869116D57A0C5C6B161C60C922032CC51D7021883D9DA90619D70BB29525F255FFA668218D8B4DF1FBCEBF74E348CAC4C10F837B33381F1B36A84E85A0A6569F742A4E0578911BB335A4E515D13E11AA4ED0B7B7D7C952CFBA233E8BEAE00C6DA4CC4AD27B3B5216ECE2EEB1E92B7DE199BDEA1F52606DC167BDBE728A9F3274DDEE077EEFCB75CB8F7BE43FED943B27F9AB8160982E8DB30A329FA6978658B2408626B83AE053006B3B50173639A16BC41EAAAE54B1F4D10D3F7FB6776FCDE89866B6767D6421F55039ACCCE065D4BA12CED1E9012FB155755CB96D2F9DDB76F569CA2ED710C5EFB7A647C952CFBC2289D7D21AD3711B79ECCD606AC11D34BBB762A79EBA566CB6F83B5657E08D3489D7FFE57AFF53B76FD7B6E6CD9FE967FE3CD7747C649C3B5A3A6536D1BA637698FCB1156B4FC2BB5B541D7021883D9DAB0E09E4783FE26B0276C5C06ECD93836609D99A6D04713C4B47DFEA7B6FFDE89866BBA1244E9AF2FF4074EDC4E6D92C0F8AA3FD0647636E85A0A6569F78014FA986FCC41D5B225EC3F68F6A3B4DD843ABE4E967D610CF8C13A5A6F226E3D99AD0D8397F12789A29ED9DB90B75E5A06DDC57FF92BBC2DE05B2838E822ED4B961EF63B76FF3A57A079F690F32363D9102408A269C3F4324910AB7E4E6D6DD0B500C660B6796108DC11B2F8F2B14B1083A6EEF33FBDF583BA31E0EACA4F21F837B3B3017351B514CAD2EE0129D888888DD3B89BDEEBE9EFB28E0DFF32A1C20795BCF765F0A2E3B4DE44DC7A325B1BCE5CCA13C4C0EFAF0BC67281E9611C367E351870C312EA83B05CDAE53FFC3EF63787DDEA77EC793777DADA5F95203423325E12E8C3F46C985E8E3E5577C56A4910C4D6065D0B600C669B1769D62C8B2F8671FA66823863CA3EFFAC2D1FD48D0157690942FECDEC6CC05C542D85B2B47B40CA30A5BE8781D72FA19A263E756F6FC07359477DEE2AF5DE1710B79ECCD60675BDAA09C661E35703367E3743A55DFE133C4387B5FB73E63F4083481E344ED948C78CE3DAD11912C44C9220D61CA7B636E85A006330DBBCC0FCD9B88C2CBE18C6E9A309E28E7DFE67367F5037747F065C399BDAD980B9E87ADD94A5DD03F87FA5BE079775F8D492DE8037F0BA25D4C684C1DFBAEF0B88F38FD9DAA0AE5735C1386CFC6A807D673E08374B7B78CC1D53EA2B582E8174C7DEDF5485E6E53FF3CF3EC7EE96130217D3B061FACC9D11BD2CF3D2B500C660B679912E41B8FBF2F14B1093F7F97FB6E983BAF0E9C52F44FC19306236B5B50173D1F5BA294BBB07A4D0C77C9F39E730D534A18EE7E2F7E0198F54F8A052CF7D09895B4F666B03DBEF6A8071D8F8D500C70DF3413820EDE13177A9525FC1D9E77CD56F5EF133091EEF5585356DA78231D8D82AD77CBB89F6B761DA2C9220D63E436D6DD0B500C660B67981F9B37119597C318CD33713C4E049F7FB7FD626077B1D1834666DC49F20D0125B1B30175DAF9BB2B47B400AFD0DC4A7174950219A26D4F15CFCC698AA0F2AF5DC9790B8F564B63698E69B272E7BE9CA675AF8A321BAF99CD884C75D87521F61DAAC5DFE8EFB25885481351B9393449020485F1BE0BBAE172408626B83AE05AAB93E205D8270F7E5639720EA75A5FAE965FCD57A35F804F19A52DFC359AB7E45354D0CFC4EE5ED056663E233EBF9C9008A4F10EED4F2130468B8E476EA8770A5B487C7DD67057CB389D9052078B4EF7C870696ACAC4E48129912C46C96204E505B1B742D8031986D5EA44A10197CF9F825883ADCEB3EABF53DBFE11BFCA4AAE6DF20A4C4FE0642D7B201BE66D550FBAB147F8370A7967F830086E3AE5DDAC3BF43A0E0C99CCCAE879E5B4E24B8640557F56C4C902941149F20ACF9F825881A7F5B06DF30297D31FEB935D5FC169314FA98EF866F4CA07A49A09FAA7356DB7BD4CE44DC37995CF6E5532B5FA7F5AE14DF62B203EBCEFC10DE96F6F0DB73F84D04BED184574732DB0A1AA76EF2DB3B7F45EF6367E196DB5BE878418220F636147F83B0E7639720F05D72FDBBDDD500DFC3D77FF3C0A8E6EF20A4601322EDAE63EA3A2EDFBFC76F00741DE0B22F79EF65DC7A325B1BE27E079137997E07B1E93D5E9F40E99FBE4D7D119014F0C901CFF667EDB17CE58291FE9AB61725B0F06FC4B8B0610BBFB55B7C8BA9F816134D10597EB13B78F5EBC1AF5619D005E1AFAD6DA9E62FA9A58C53EA7A70FD15B8AE8379333B13713EBBEC4BC3A51368BD2B71BE315B1BB03E4C0F7E63DF5D607A2EFB107246F3715A9F047EA9CE7C11B690BA54E4FD1B801BC72C8C8C81C0C56C6DE8EBBF83C06F42303F13B65F0706FDEA7710599EF9A33F8B290FAAF92C2629F431DF2E6BC09EA53468C1116A6BE28C25C7233AC0C527F41BDCF60E6D73A13F3E8B69E0A4EDB43E89B87D14F00274569F0AFCF27ACD861768D049CB1CF2A6C04FF22FA95D7E59DECD0952D7BF7E499DE7D35CF3A09A4F739542BFE2EAF2F44FF6645297B58C7BC2A98B16FA0DBAE7086D73A13F3ECDB5F4AD09B4DE06E64B9EE0394B0B163D4A9FF19386B5AD2723DA9FE46731A579CE92C67252572D5FFA6682C8F2DE01F63E88AC54F37D1052E863BE9DDE1FD0FE4E309E8AEB7B08984FD063B626D0AF61CCBDB4CD05F8A0FB0598AD0D1F87F741A0FFA08EFFA06D4960ED755FAAC1ADB7ADA04F0A4D83AE1924086267039E6EAAEBF5A5A7B96648103466F6ABA7B9667973197BA39C2578F4C068AD2EA05A6F941362BFE2CAB46A49F8C63715977D09FBB23617FAE31BE582FE2B9EA16D490C5C7224E20BC3F55D09AAC637BF758BBF75DB9BD4CE06FDBD04C5FB20228C1168CCEC57EF83C8F2EEE3A4F72A6B3C29E02B7E97485FF94FB02011BB6ABD935AA08FF9F6FECFD7A8562D61EBE8B22F61DF012DCFD0F6B4F4D77752374CDB41DB12D9C1839B8EEBDBD6749D49935AA99D0DFA9BCD8A37CA05E06F0EB8AD344440E109A23FBD51AE61EE017FE0837F74A2747D6C82C0BD7EFC4118635E289C29F69E8A149E204413DA2E602E4C53803FF4EF0F59C6CB8B8619D12B30977D09FB961AD7D3F6B4C4AD27B3B561405B4C82907A666F4335F44A574CA46D36A0AFEE8F8EEBFB9A751DBC979AD9D980E4A26AF5D37752230685E002522F3C41F4A7775297E61FF007FC584E5E074A37FC30A2D7CDF9D2EE99808D62DF0334A5DD09CC85699A28DD721FD5AA25CC6F977DE9E97FF175B43D2D71EBC96C6D68D8C41304EA99BD0DD5D21BB0FF3F697B1236C7E0CAE547FD9D3B7E959A3CB5664CDF56A183C0C5EC6CD0B580AB5F40D7021883D9DA902128C72488BAF8121416DB75686512527882B8FB80DFF0889CBC0E946E8C4F10D2EE99808D62DF0334A5DD09CC85699AC832FFDC687F2917BFD4FE0D1D6F509B34C4ADA7B3369967A027F5D43E89BCF5841E8DD613B43D11591BD51746CBB2A7FC9DDBDF4E0DD35A78D743D43689A6695B2B74BE75E9F7A99D0DBA16709DE3B6CDFC877C1883D9DB30F29AA95453704A1075F225282CB6EBD0CA24A4F004B15002D1E31F3AE1DD6448108F7FE899808D62DF8B684ABB13980BD534505AFD14D5AA25A5FDD16F6EB8EC4BD6FE3A71EB59DA260198D827817E7D590FF468CCE9A0ED36785FBFAEC21F9D96653FF3776EFB656A9856D39D12AC886D12E8A76B313B1B9896EB1CD14FD702AEF30423AFCE3941D4C797A0B0D8AE432B9390C213C4A207FCD24139D91CF0C6C4270869F74CC046B1EF4534A5DD0D990BD53450DAF112D7AA3111BF1CF6A542E39A89D4261531EBE9BC66D2AF4FEB093D3A19D6CF9B56797F5FA765E9117FD7D6B752C3B49AA66EA1B649A09FAEC5EC6C605AAE73443F5D0BB8CE138CBC7A0AD514DC12447D7C090A8BED3AB432092974B25EB30481437250BB30363E4148BB67242E4140938D6503E6C2344D3CF46BAE556B463656FAE5B22F6A7FF0F8FBDCCE96B8F55CF904B74FA29307746FDF9BDC3E09F8C1F4300EB3B741D5715DBF2DCF56EA68DC33EF417FD7963753C3B49AA6B653DB24D04FD762763630AD96FB244110DB24D04FD702AEF304A3AECA3B41D4C597A0B0D8AE432B9390C213C4BD12048EC841EDC2F70C09E2882401137109029A6C2C1B1E9660BFFB6533E50D95E3319D7AA0AFA5CBBEA8FD41DB53DCCE16F8A06B822CC70CD3637636C4F9877D66F636A83ADB24D0331B1B541D8DA6299BFD5DED6FA4264F2DF4D3B536AF7D9EDA2631AF1C7DDCB7ABD63D73F99EBACE138CBAEA0EAA29B82588FAF8121416DB75686512527882582A1B72F4BFDDF8FEDCA85E17E74BBB67242E4140938D9517986F38D6BF5CC76D6C784C9211B47498AD0DE8ABAE838B96DA1F4C5ECAED6CD17D0AC9B2475873552BCB1EC41D7F7B2541307B1B549D059DDCC606ACBDAAA570C7F8D5FEAECDBF48CDB06F8C8D68AD5AF224B54D62D495D140E5AA857EBA16B3B3A17C47347101D4337B1BD85CBB714A1075F225282CB6EBD0CA24A4F004B1FC41DF7B5A0E68176E312488A7250998884B10D06463E505E69BC7589DCF55FA1D72F8BFB87D12ED472B755CF645ED0FFEE16BDCCE1675ADF2D2D5E7897F333B1BE087AA15B24F1204B3B741D5F94E23B7B1419FA7C2A82B27FBBB37BD9E9A71639B2B74865D3296DAD9001F542D306F4627B54D62F3EACA5B6AAEF30337C7FCF8B63C7913B5B781CDB51BB704511F5F82C262BB0EAD4C420A4F102B25081C9703DA855B0D09E2B82401137109029A6CACBCC07CC3B116CB1522B3B141D5513920C189D927817EAA8ECBBEA8FD4376492263B636C4CD113CF216EF63C3C177BBE68BFFB2761B303EF30BB8EE01D0B59E9284CFEC92C0DC74AD6E86FCD579FEEE8DAFA566C7FA53FE1DB7ADF2478D982CC96271F06F6667037CD0FD1A23C199D9DAB0F4EE4702BFA0D1BAEC28B5B181F905CA9337527B1BE017D3141C13445D7C090A8BED3AB43209293C41B4481038F1911BB71912C4898F3C237109029A6CACBCC07CC3B1B2CC5DD55179F0156E9FC4310944AA8E8B6F6AFF90664982CCD686B839822C6B970773B5BF25A9B8EE01D0B5F648826576365CAF7DF140A175A904D1B657EB427B4BFCAB47D1C6FAD48265773D4C7D02E5491294491F1B468D98443505B704511F5F82C262BB0EAD4C420A4F10ABE5447F4E0E6617C61912C47392044CC4250868B2B1F202F30DC7BA5F4E7E666383AAA3F2900427666F83AAE3B22F6AFF9061D7735B1BE2E608B2E866E5885C9D7FF922EE17C86B0FC0BD9260999D0D86F59B72EB4A0918AFD485F9D3A28F76092937B6D13EB560D415B1C133935F065DB704511F5F82C262BB0EAD4C420A4F106BE5203E2907B30BB71B12C449490226E2120434D9587981F986633D2C8184D9D81037F7BCD6D34547F543E5E02FB97D12EA5A31B2CC350BF1C75D1759F655D7FAAE7C0A60763660DD75BD6E867CE15CBF63CD497FCF86976BCEB0AFDF4C7D0A695F719CF6AB26CBE63D447D0999D9B881F6B361F415B19FE49C12449D7C090A8BED3AB43209293C41AC9393FC4539985D986048102F4A1230119720A0C9C6CA0BCC371C8BB5DB1237F72CEBB9A02D9B8EEA87CA969F70FB24D4B58AE3900441D6B75AA86B14C7A39220585F1B98DE89DF715B1BBE398A6B0A536E59E1EF6995C0514396CD350762305C1208EB5B2D3A563F1F244CE64BC8CC891294495F1B465F9E7382A88F2F4161B15D87562621852788560902A7E5407661A221419C962460222E4140938D9517986F38166BB7256EEE59D653F5CD4547F543E526F958CBEC9350FD8963E845BE77589204EB9F370B2D9203785C1204EB6F03D37BF0796E6B4382CF8BCB7BFC3DEB5FAA091B9A8F2406E290F1372DA41A79D3B1EA79494837511F54664E68A5FD6D187D79EC1376DD12447D7C090A8BED3AB43209293C416CF8915F7AF92327BCC67951BD2ECE9776CF046C14FB5E4453DAAB06E69BC738DEB931F7C0672DA3F636780F49200A751CF6A5C20F8DD2C9DFD13E267AD62A09AC85F8CE3472417CC7BAD2B1194FBCC2752CA07A2B76525B1B2AF63486C54D9224D69DAE2A1B9A0FFBE77C61281D3F8EF1374A92205A79D1B1EA397FF83F272707100465A261C3E8CBAA9020C8383664F025282CB6EBD0CA24A4F004D12681E8953F39E14D32248857FEE499808D62DF8B684A7BD5C07C8371664B2027EDB644FC0EC9E2FF41B9F20D751CF6A5C20F9DFB8FD13E267AD6CA96456D7EE999DF502D57E0776C328E01EBC8B46C607ADE9849D4D616AAA9317664D9EF6879D6DFBBF674EECCBC7D3D1DD30604B42D4B9FA6BA595873F763FE055FBE9C8EC9C01C988E0DB92788FAF8121416DB7568651252AE837E84C5F211F8A7AFBA21270ED5F4BC2F79AF491230011BD6179A6CACBCC07C314E967903DDEF90ACFE873A2EFEA97EE82099B33E26C2B54A0BFA1D7DDB977D76E3D407BEB75F12C388EBB97E121D07F97C6C607A80D9DA127F9E5470CE5F0E0D824FE74A248A539980C6E219BB6D83F03C52D7439E7E6DB9EF983FFEBB0BE83826BA8232D74C62F4F0095453C89020F8584964F025282CB6EBD0CA24A4FC2FE8D780F7BDD72501D8005BAE51F0490001BE599245A704EC4312288F49D2785D12800EEAD1BE493EB1CC49712BC9F31E20759F08C65E5BF69B67EC0A02EADE352F5AD1B9F284BF7CF6034100465067BA04BC7B19C56A2D43BF3016F3818139A08F21382672C1972F0BFABB60580BF61639B5E06D98917E75F225282CB6EBD0CA24BACBDB82EA54353820D816D8328D82BE0B8E210415D6564BB6087FAED57D220903D2F81BEEF6678E5F57C1D4EF2D0BDA60C3FA26102687B0A44AB8A15FF041F70BBE2604C4388C9F667204EF9F4E2A670AAC6FDED8F8121416DB75686512DD65BAA03A560D2E156C0B6C994641DF05C710CADF0BC70466536D1A85B07408CCA6AF739CD4D58A778511022B2B04D6A7164C1650DA05D69E27CB059BD2977CA1B15D875626A1946A7E2C47F64F5B6A75C550901D1C3B7A41C2C0FD42669F370F0B4305B57C56A8C527E33C09CF13243AD65E4DD60A9F134CA5D69F105F162E12C2F28F02B3CB9321824DE94BBED0D8AE432B93D00A4EEA3C4F2A6C709A4F0E7A415F6830EDBE4E38F7BEE47F78C28DEEFE7F6693061C2BE1270756BE28A01D57A6AC7F5690182E11E20A9244DE9F24B06E79EF29F4F4F304090F419BD9E749D21AEA0541ABDA7EE1C202C7CD59825EF06982F5C903FDD65A52E933BEB0D8AE432B9320059B72B1304B78CC11F48506DBE0B4250F7F6C087DCE3A8E3EF7BCFCCFE29FEE134A16BF989EA9E0CAF44A011FCBB35E809C142609FA270653C1DF242E13160B6C3E36A873CE7B4F4DEB887962BE98375B0F17B007B87D91660DF5520DBF9E146E167061612AB87AC7B1F486C074D280FBFC580BEBAB75ADF4095F586CD7A1954914A5287528F8E61CBE5E1D06EC9F0BEA891282FA30900E13FEA7D09F0B02270268DA80F45B61AF9036B1DA963059600C8CC57C60BC26B409364921AE7C5EC057415DB0FA86508A52375F586CD7A1954914A5287DA49408453197302021D9E2BBF92AE304B4C1A6D625F40B3EE87EC1D7CC01B1289585C5761D5A595050505050402B0B0A0A0A0A0A6865414141414101AD2C2828282828A095050505050505B4B2A0A0A0A0A080561614141414F4777CEFFF034FCD7AB84D737B420000000049454E44AE426082, N'0776472166', 10, 1, CAST(0.00 AS Decimal(18, 2)), NULL)
GO
SET IDENTITY_INSERT [dbo].[Settings] OFF
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DF_BillItems_item_quantity]') AND type = 'D')
BEGIN
ALTER TABLE [dbo].[BillItems] ADD  CONSTRAINT [DF_BillItems_item_quantity]  DEFAULT ((0)) FOR [item_quantity]
END
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DF_Bills_unpaid]') AND type = 'D')
BEGIN
ALTER TABLE [dbo].[Bills] ADD  CONSTRAINT [DF_Bills_unpaid]  DEFAULT ((0)) FOR [unpaid]
END
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DF_Deductions_emp_id]') AND type = 'D')
BEGIN
ALTER TABLE [dbo].[Deductions] ADD  CONSTRAINT [DF_Deductions_emp_id]  DEFAULT ((0)) FOR [emp_id]
END
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DF_Discounts_quantity_end]') AND type = 'D')
BEGIN
ALTER TABLE [dbo].[Discounts] ADD  CONSTRAINT [DF_Discounts_quantity_end]  DEFAULT ((0)) FOR [quantity_end]
END
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DF_Employees_salary]') AND type = 'D')
BEGIN
ALTER TABLE [dbo].[Employees] ADD  CONSTRAINT [DF_Employees_salary]  DEFAULT ((0)) FOR [salary]
END
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DF_Items_ItemQuantity]') AND type = 'D')
BEGIN
ALTER TABLE [dbo].[Items] ADD  CONSTRAINT [DF_Items_ItemQuantity]  DEFAULT ((0)) FOR [ItemQuantity]
END
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DF_Items_ItemPrice]') AND type = 'D')
BEGIN
ALTER TABLE [dbo].[Items] ADD  CONSTRAINT [DF_Items_ItemPrice]  DEFAULT ((0)) FOR [ItemPrice]
END
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DF_Items_ItemPriceTax]') AND type = 'D')
BEGIN
ALTER TABLE [dbo].[Items] ADD  CONSTRAINT [DF_Items_ItemPriceTax]  DEFAULT ((0)) FOR [ItemPriceTax]
END
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DF_Items_Favorite]') AND type = 'D')
BEGIN
ALTER TABLE [dbo].[Items] ADD  CONSTRAINT [DF_Items_Favorite]  DEFAULT ((0)) FOR [Favorite]
END
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DF_Items_Warehouse_id]') AND type = 'D')
BEGIN
ALTER TABLE [dbo].[Items] ADD  CONSTRAINT [DF_Items_Warehouse_id]  DEFAULT ((0)) FOR [Warehouse_id]
END
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DF_Items_ItemType]') AND type = 'D')
BEGIN
ALTER TABLE [dbo].[Items] ADD  CONSTRAINT [DF_Items_ItemType]  DEFAULT ((0)) FOR [ItemType]
END
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DF_Items_QuantityWarning]') AND type = 'D')
BEGIN
ALTER TABLE [dbo].[Items] ADD  CONSTRAINT [DF_Items_QuantityWarning]  DEFAULT ((0)) FOR [QuantityWarning]
END
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DF_Settings_SystemName]') AND type = 'D')
BEGIN
ALTER TABLE [dbo].[Settings] ADD  CONSTRAINT [DF_Settings_SystemName]  DEFAULT (N'PlancksoftPOS') FOR [SystemName]
END
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DF_Settings_SystemReceiptBlankSpaces]') AND type = 'D')
BEGIN
ALTER TABLE [dbo].[Settings] ADD  CONSTRAINT [DF_Settings_SystemReceiptBlankSpaces]  DEFAULT ((0)) FOR [SystemReceiptBlankSpaces]
END
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DF_Settings_SystemIncludeLogoInReceipt]') AND type = 'D')
BEGIN
ALTER TABLE [dbo].[Settings] ADD  CONSTRAINT [DF_Settings_SystemIncludeLogoInReceipt]  DEFAULT ((0)) FOR [SystemIncludeLogoInReceipt]
END
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DF_Settings_SystemTax]') AND type = 'D')
BEGIN
ALTER TABLE [dbo].[Settings] ADD  CONSTRAINT [DF_Settings_SystemTax]  DEFAULT ((0)) FOR [SystemTax]
END
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DF_TransactionItems_item_quantity]') AND type = 'D')
BEGIN
ALTER TABLE [dbo].[TransactionItems] ADD  CONSTRAINT [DF_TransactionItems_item_quantity]  DEFAULT ((0)) FOR [item_quantity]
END
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DF_Users_Authority]') AND type = 'D')
BEGIN
ALTER TABLE [dbo].[Users] ADD  CONSTRAINT [DF_Users_Authority]  DEFAULT ((0)) FOR [Authority]
END
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DF_VendorBillItems_item_quantity]') AND type = 'D')
BEGIN
ALTER TABLE [dbo].[VendorBillItems] ADD  CONSTRAINT [DF_VendorBillItems_item_quantity]  DEFAULT ((0)) FOR [item_quantity]
END
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DF_VendorBills_unpaid]') AND type = 'D')
BEGIN
ALTER TABLE [dbo].[VendorBills] ADD  CONSTRAINT [DF_VendorBills_unpaid]  DEFAULT ((1)) FOR [unpaid]
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[AddItemToBill]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[AddItemToBill] AS' 
END
GO
ALTER procedure [dbo].[AddItemToBill]
    @BillID int,
	@ItemBarCode nvarchar(255),
	@ItemQuantity int
AS
BEGIN
    
	INSERT INTO BillItems(bill_id, item_barcode, item_quantity) VALUES (@BillID, @ItemBarCode, @ItemQuantity)
	UPDATE Discounts SET quantity_end = quantity_end - @ItemQuantity WHERE item_barcode = @ItemBarCode
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[AddItemToClient]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[AddItemToClient] AS' 
END
GO
ALTER procedure [dbo].[AddItemToClient]
    @ClientID int,
	@ItemBarCode nvarchar(255),
	@ItemPrice decimal(18, 2),
	@Status int OUTPUT
AS
BEGIN
    IF NOT EXISTS (SELECT * FROM ClientsItems 
		WHERE Client_id = @ClientID
		AND item_barcode = @ItemBarCode
		AND item_price = @ItemPrice)
		BEGIN
			INSERT INTO ClientsItems(Client_id, item_barcode, item_price) VALUES (@ClientID, @ItemBarCode, @ItemPrice)
			set @Status = 1
		End
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[AddItemToVendorBill]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[AddItemToVendorBill] AS' 
END
GO
ALTER procedure [dbo].[AddItemToVendorBill]
    @BillID int,
	@ItemBarCode nvarchar(255),
	@ItemQuantity int
AS
BEGIN
    
	INSERT INTO VendorBillItems(bill_id, item_barcode, item_quantity) VALUES (@BillID, @ItemBarCode, @ItemQuantity)
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[AddPrinterItemType]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[AddPrinterItemType] AS' 
END
GO
ALTER procedure [dbo].[AddPrinterItemType]
	@printer_id int,
	@itemType_id nvarchar,
	@Status int OUTPUT
AS
BEGIN
	INSERT INTO PrinterItemType(printerID, itemTypeID)VALUES(@printer_id, @itemType_id)
set @Status = 1
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[AddSaleOnItem]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[AddSaleOnItem] AS' 
END
GO
ALTER procedure [dbo].[AddSaleOnItem]
    @ItemBarCode nvarchar(255),
    @saleRate int,
	@StartDate Date,
	@EndDate Date,
	@QuantityEnd int = 0,
	@Status int OUTPUT
AS
BEGIN
IF NOT EXISTS (SELECT * FROM Discounts 
		WHERE item_barcode = @ItemBarCode
		AND (( start_date >= @StartDate AND end_date <= @EndDate)) OR quantity_end < @QuantityEnd)
		BEGIN
			INSERT INTO Discounts(item_barcode, sale_rate, start_date, end_date, quantity_end) VALUES(@ItemBarCode, @saleRate, @StartDate, @EndDate, @QuantityEnd)
			set @Status = 1
		End
		Else
		Begin
			UPDATE Discounts SET sale_rate = @saleRate, quantity_end = @QuantityEnd WHERE item_barcode = @ItemBarCode
		End
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[AddUnpaidBill]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[AddUnpaidBill] AS' 
END
GO
ALTER procedure [dbo].[AddUnpaidBill]
    @cashierName nvarchar(255),
	@totalAmount decimal(18, 2),
	@Date Date,
	@ClientID int,
	@BillID int OUTPUT,
	@Status int OUTPUT
AS
BEGIN
	INSERT INTO Bills(cashierName, totalAmount, paidAmount, remainderAmount, paymentByCash, date, unpaid, ClientID) VALUES(@cashierName, @totalAmount, 0, @totalAmount, 1, @Date, 1, @ClientID)

DECLARE @bill_id INT = (SELECT TOP 1 Bills.id FROM Bills WHERE Bills.id = SCOPE_IDENTITY() ORDER BY Bills.id DESC)
set @BillID = @bill_id
set @Status = 1
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[AddVendorBill]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[AddVendorBill] AS' 
END
GO
ALTER procedure [dbo].[AddVendorBill]
    @cashierName nvarchar(255),
	@totalAmount decimal(18, 2),
	@Date Date,
	@BillID int OUTPUT,
	@Status int OUTPUT
AS
BEGIN
	INSERT INTO VendorBills(cashierName, totalAmount, date) VALUES(@cashierName, @totalAmount, @Date)

DECLARE @bill_id INT = (SELECT TOP 1 id FROM VendorBills ORDER BY id DESC)
set @BillID = @bill_id
set @Status = 1
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[CheckAdmin]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[CheckAdmin] AS' 
END
GO
ALTER procedure [dbo].[CheckAdmin]
    @UserID nvarchar(255),
	@Status int OUTPUT
AS
BEGIN
DECLARE @cnt INT = (SELECT COUNT(UID)FROM Users Where UID = @UserID AND Authority='1')
set @Status = @cnt
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[CreateTransaction]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[CreateTransaction] AS' 
END
GO
ALTER procedure [dbo].[CreateTransaction]
	@EntryExitType int,
	@cost decimal(18, 2),
	@Date Date,
	@cashierName nvarchar(255),
	@TransactionID int OUTPUT,
	@Status int OUTPUT
AS
BEGIN
	INSERT INTO Transactions(cashierName, date, type, time) VALUES (@cashierName, @Date, @EntryExitType, getdate())
	set @TransactionID = (SELECT TOP 1 id FROM Transactions WHERE cashierName = @cashierName AND date = @Date AND type = @EntryExitType ORDER BY id DESC)
	if @EntryExitType = 0
		INSERT INTO Expenses(name, cost, employee_id, date) VALUES (convert(nvarchar, N' سند ادخال ') + convert(nvarchar, @TransactionID), @cost, @cashierName, GETDATE())
	set @Status = 1
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DeleteAbsence]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[DeleteAbsence] AS' 
END
GO
ALTER procedure [dbo].[DeleteAbsence]
    @AbsenceID int,
    @Status int OUTPUT
AS
BEGIN
    DELETE Absence WHERE id = @AbsenceID
set @Status = 1
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DeleteClient]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[DeleteClient] AS' 
END
GO
ALTER procedure [dbo].[DeleteClient]
    @ClientID nvarchar(255),
    @Status int OUTPUT
AS
BEGIN
    DELETE ClientsVendors WHERE ID = @ClientID
set @Status = 1
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DeleteEmployee]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[DeleteEmployee] AS' 
END
GO
ALTER procedure [dbo].[DeleteEmployee]
    @EmployeeID nvarchar(255),
    @Status int OUTPUT
AS
BEGIN
    DELETE Employees WHERE id = @EmployeeID
set @Status = 1
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DeleteFavoriteCategory]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[DeleteFavoriteCategory] AS' 
END
GO
ALTER procedure [dbo].[DeleteFavoriteCategory]
	@CategoryID int,
	@Status int OUTPUT
AS
BEGIN
    DELETE FROM FavoriteCategories WHERE id = @CategoryID
set @Status = 1
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DeleteFavoriteItem]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[DeleteFavoriteItem] AS' 
END
GO
ALTER procedure [dbo].[DeleteFavoriteItem]
@item_barcode nvarchar(255),
@Status int OUTPUT
AS
BEGIN
    UPDATE Items SET Favorite = '0' WHERE ItemBarCode = @item_barcode
set @Status = 1
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DeleteItem]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[DeleteItem] AS' 
END
GO
ALTER procedure [dbo].[DeleteItem]
    @ItemBarCode nvarchar(255),
    @Status int OUTPUT
AS
BEGIN
    DELETE Items WHERE ItemBarCode = @ItemBarCode
	DELETE Discounts WHERE item_barcode = @ItemBarCode
set @Status = 1
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DeleteItemType]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[DeleteItemType] AS' 
END
GO
ALTER procedure [dbo].[DeleteItemType]
	@ItemTypeID int,
	@Status int OUTPUT
AS
BEGIN
    DELETE FROM ItemTypes WHERE id = @ItemTypeID
set @Status = 1
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DeletePrinter]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[DeletePrinter] AS' 
END
GO
ALTER procedure [dbo].[DeletePrinter]
	@printer_id int,
	@machine_name nvarchar(255),
	@Status int OUTPUT
AS
BEGIN
	DELETE FROM PrinterItemType WHERE printerID = @printer_id
    DELETE FROM Printers WHERE id = @printer_id AND machineName = @machine_name
set @Status = 1
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DeletePrinterItemType]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[DeletePrinterItemType] AS' 
END
GO
ALTER procedure [dbo].[DeletePrinterItemType]
	@printer_id int,
	@itemType_id nvarchar,
	@Status int OUTPUT
AS
BEGIN
    DELETE FROM PrinterItemType WHERE printerID = @printer_id AND itemTypeID = @itemType_id
set @Status = 1
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DeleteUser]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[DeleteUser] AS' 
END
GO
ALTER procedure [dbo].[DeleteUser]
    @UserID nvarchar(255),
    @Status int OUTPUT
AS
BEGIN
	DECLARE @UID INT = (SELECT id FROM Users Where UID = @UserID)
    DELETE Users WHERE UID = @UserID
	DELETE FROM UserPermissions WHERE user_id = @UID
set @Status = 1
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DeleteWarehouse]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[DeleteWarehouse] AS' 
END
GO
ALTER procedure [dbo].[DeleteWarehouse]
	@WarehouseID int,
	@Status int OUTPUT
AS
BEGIN
    DELETE FROM Warehouses WHERE id = @WarehouseID
set @Status = 1
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[GetCapitalAmount]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GetCapitalAmount] AS' 
END
GO
ALTER procedure [dbo].[GetCapitalAmount]
	@Amount decimal(18, 2) OUTPUT,
	@Status int OUTPUT
AS
BEGIN
	set @Amount = (SELECT (SumOfInventory.SumOfInventory - cost.cost) + Revenue.Revenue from (SELECT sum(Items.ItemPriceTax * Items.ItemQuantity) as SumOfInventory From Items Where Items.ItemQuantity >= 0) as SumOfInventory, (SELECT sum(Expenses.cost) as cost FROM Expenses) as cost, (SELECT sum(Bills.paidAmount - Bills.remainderAmount) as Revenue FROM Bills) as Revenue)
	set @Status = 1
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[GetLastOpenRegisterDate]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GetLastOpenRegisterDate] AS' 
END
GO
ALTER procedure [dbo].[GetLastOpenRegisterDate]
	@Date date OUTPUT,
	@Status int OUTPUT
AS
BEGIN
	set @Date = (SELECT TOP 1 date FROM RegisterHistory WHERE openorclose = 1 ORDER BY date DESC)
	set @Status = 1
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[GetOpenRegisterAmount]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GetOpenRegisterAmount] AS' 
END
GO
ALTER procedure [dbo].[GetOpenRegisterAmount]
	@Amount decimal(18, 2) OUTPUT,
	@Status int OUTPUT
AS
BEGIN
	set @Amount = (SELECT TOP 1 moneyInRegister FROM RegisterHistory WHERE openorclose = 1 ORDER BY date DESC)
	set @Status = 1
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[GetTotalSalesAmount]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GetTotalSalesAmount] AS' 
END
GO
ALTER procedure [dbo].[GetTotalSalesAmount]
	@Date date,
	@Amount decimal(18, 2) OUTPUT,
	@Status int OUTPUT
AS
BEGIN
	set @Amount = (SELECT sum(totalAmount) FROM Bills WHERE ported = 0 AND date = @Date)
	set @Status = 1
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[GetTotalSalesAmountCloseCash]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[GetTotalSalesAmountCloseCash] AS' 
END
GO
ALTER procedure [dbo].[GetTotalSalesAmountCloseCash]
	@Amount decimal(18, 2) OUTPUT,
	@Status int OUTPUT
AS
BEGIN
	set @Amount = (SELECT sum(totalAmount) FROM Bills WHERE ported = 0)
	set @Status = 1
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[InsertAbsence]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[InsertAbsence] AS' 
END
GO
ALTER procedure [dbo].[InsertAbsence]
	@EmpID int,
	@Date date,
	@Hours int,
	@Status int OUTPUT
AS
BEGIN
	INSERT INTO Absence(emp_id, date, hours) VALUES (@EmpID, @Date, @Hours)
set @Status = 1
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[InsertDayOff]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[InsertDayOff] AS' 
END
GO
ALTER procedure [dbo].[InsertDayOff]
	@EmpID int,
	@Date date,
	@Status int OUTPUT
AS
BEGIN
	INSERT INTO Absence(emp_id, date, hours) VALUES (@EmpID, @Date, 8)
set @Status = 1
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[InsertDeduction]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[InsertDeduction] AS' 
END
GO
ALTER procedure [dbo].[InsertDeduction]
	@EmpID int,
	@Date date,
	@Deduction decimal(18, 2),
	@Status int OUTPUT
AS
BEGIN
	INSERT INTO Deductions(emp_id, date, deduction) VALUES (@EmpID, @Date, @Deduction)
set @Status = 1
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[InsertEmployee]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[InsertEmployee] AS' 
END
GO
ALTER procedure [dbo].[InsertEmployee]
    @EmployeeName nvarchar(255),
	@Salary decimal(18, 2),
	@Phone nvarchar(255),
	@Address nvarchar(255),
	@Status int OUTPUT
AS
BEGIN
    INSERT INTO Employees(name, salary, phone, address) VALUES (@EmployeeName, @Salary, @Phone, @Address)
set @Status = 1
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[InsertExpense]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[InsertExpense] AS' 
END
GO
ALTER procedure [dbo].[InsertExpense]
	@ExpenseName nvarchar(255),
	@ExpenseCost decimal(18, 2),
	@EmployeeID nvarchar(255),
	@Date date,
	@Status int OUTPUT
AS
BEGIN
    INSERT INTO Expenses(name, cost, employee_id, date) VALUES (@ExpenseName, @ExpenseCost, @EmployeeID, @Date)
set @Status = 1
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[InsertFavoriteCategory]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[InsertFavoriteCategory] AS' 
END
GO
ALTER procedure [dbo].[InsertFavoriteCategory]
	@CategoryName nvarchar(255) = NULL,
	@Status int OUTPUT
AS
BEGIN
IF NOT EXISTS (SELECT * FROM FavoriteCategories 
		WHERE name = @CategoryName)
		BEGIN
			INSERT INTO FavoriteCategories(name) VALUES (@CategoryName)
			set @Status = 1
		End
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[InsertItem]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[InsertItem] AS' 
END
GO
ALTER procedure [dbo].[InsertItem]
    @ItemName nvarchar(255),
    @ItemBarCode nvarchar(255),
	@Quantity int,
	@BuyPrice decimal(18, 2),
	@Price decimal(18, 2),
	@PriceTax decimal(18, 2),
	@ItemTypeID nvarchar(255),
	@WarehouseID nvarchar(255),
	@Favorite nvarchar(255),
	@Date Date,
	@Picture varbinary(MAX) = NULL,
	@WarningQuantity int = 0,
	@ProductionDate date = NULL,
	@ExpirationDate date = NULL,
	@EntryDate date = NULL,
	@Status int OUTPUT
AS
BEGIN
    INSERT INTO Items(ItemName, ItemBarCode, ItemQuantity, ItemBuyPrice, ItemPrice, ItemPriceTax, ItemType, Warehouse_id, Favorite, Date, Picture, QuantityWarning, ProductionDate, ExpirationDate, EntryDate) VALUES(@ItemName, @ItemBarCode, @Quantity, @BuyPrice, @Price, @PriceTax, @ItemTypeID, @WarehouseID, @Favorite, @Date, @Picture, @WarningQuantity, @ProductionDate, @ExpirationDate, @EntryDate)
set @Status = 1
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[InsertItemType]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[InsertItemType] AS' 
END
GO
ALTER procedure [dbo].[InsertItemType]
	@ItemTypeName nvarchar(255) = NULL,
	@Status int OUTPUT
AS
BEGIN
IF NOT EXISTS (SELECT * FROM ItemTypes 
		WHERE name = @ItemTypeName)
		BEGIN
			INSERT INTO ItemTypes(name) VALUES (@ItemTypeName)
			set @Status = 1
		End
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[InsertPrinter]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[InsertPrinter] AS' 
END
GO
ALTER procedure [dbo].[InsertPrinter]
	@MachineName nvarchar(255) = NULL,
	@PrinterName nvarchar(255) = NULL,
	@Status int OUTPUT
AS
BEGIN
IF NOT EXISTS (SELECT * FROM Printers 
		WHERE printerName = @PrinterName AND machineName = @MachineName)
		BEGIN
			INSERT INTO Printers(machineName, printerName) VALUES (@MachineName, @PrinterName)
			set @Status = 1
		End
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[InsertWarehouse]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[InsertWarehouse] AS' 
END
GO
ALTER procedure [dbo].[InsertWarehouse]
	@WarehouseName nvarchar(255) = NULL,
	@Status int OUTPUT
AS
BEGIN
IF NOT EXISTS (SELECT * FROM Warehouses 
		WHERE name = @WarehouseName)
		BEGIN
			INSERT INTO Warehouses(name) VALUES (@WarehouseName)
			set @Status = 1
		End
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[LoginAccount]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[LoginAccount] AS' 
END
GO
ALTER procedure [dbo].[LoginAccount]
    @UserID nvarchar(255),
    @UserPWD nvarchar(255),
	@Name nvarchar(255) OUTPUT,
	@Authority int OUTPUT,
	@Status int OUTPUT
AS
BEGIN
DECLARE @cnt INT = (SELECT COUNT(UID)FROM Users Where UID = @UserID AND PWD = @UserPWD)
DECLARE @name2 nvarchar(250) = (SELECT cashierName FROM Users Where UID = @UserID AND PWD = @UserPWD)
DECLARE @authority2 int = (SELECT authority FROM Users WHERE UID = @UserID AND PWD = @UserPWD)
Set @Authority = @authority2
SET @Name = @name2
set @Status = @cnt
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[LogLogin]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[LogLogin] AS' 
END
GO
ALTER procedure [dbo].[LogLogin]
	@cashierName nvarchar(255),
	@Date datetime
AS
BEGIN
INSERT INTO LoginLogout(cashierName, date, action) VALUES (@cashierName, @Date, 'Login')
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[LogLogout]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[LogLogout] AS' 
END
GO
ALTER procedure [dbo].[LogLogout]
	@cashierName nvarchar(255),
	@Date datetime
AS
BEGIN
INSERT INTO LoginLogout(cashierName, date, action) VALUES (@cashierName, @Date, 'Logout')
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[PayBill]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[PayBill] AS' 
END
GO
ALTER procedure [dbo].[PayBill]
    @cashierName nvarchar(255),
	@totalAmount decimal(18, 2),
	@paidAmount decimal(18, 2),
	@remainderAmount decimal(18, 2),
	@paymentByCash int = 1,
	@Date Date,
	@ClientID int,
	@BillID int OUTPUT,
	@Status int OUTPUT
AS
BEGIN

IF @paidAmount >= @totalAmount
	BEGIN
		INSERT INTO Bills(cashierName, totalAmount, paidAmount, remainderAmount, paymentByCash, date, ported, unpaid, ClientID) VALUES(@cashierName, @totalAmount, @paidAmount, @remainderAmount, @paymentByCash, @Date, 0, 0, @ClientID)
	END
ELSE IF @paidAmount < @totalAmount
	BEGIN
		INSERT INTO Bills(cashierName, totalAmount, paidAmount, remainderAmount, paymentByCash, date, ported, unpaid, ClientID, payment_progress) VALUES(@cashierName, @totalAmount, @paidAmount, @remainderAmount, @paymentByCash, @Date, 0, 1, @ClientID, @paidAmount)
	END 
DECLARE @bill_id INT = (SELECT TOP 1 id FROM Bills ORDER BY id DESC)
set @BillID = @bill_id
set @Status = 1
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[PayUnpaidBill]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[PayUnpaidBill] AS' 
END
GO
ALTER procedure [dbo].[PayUnpaidBill]
    @BillID nvarchar(255),
    @paidInstallmentAmount decimal(18, 2),
	@Status int OUTPUT
AS
BEGIN
DECLARE @TotalAmount decimal(18, 2) = (SELECT totalAmount FROM Bills Where id = @BillID)
DECLARE @PaidAmount decimal(18, 2) = (SELECT paidAmount FROM Bills Where id = @BillID)

UPDATE Bills SET paidAmount = (@PaidAmount + @paidInstallmentAmount) WHERE Bills.id = @BillID

DECLARE @TotalAmountAfter decimal(18, 2) = (SELECT totalAmount FROM Bills Where id = @BillID)
DECLARE @PaidAmountAfter decimal(18, 2) = (SELECT paidAmount FROM Bills Where id = @BillID)
UPDATE Bills SET remainderAmount = (@TotalAmount - @PaidAmountAfter), postponed_bill_id = @BillID WHERE Bills.id = @BillID


IF @PaidAmountAfter >= @TotalAmountAfter
	BEGIN
		UPDATE Bills SET unpaid = 0 WHERE Bills.id = @BillID
	END
ELSE IF @PaidAmount >= @TotalAmount
	BEGIN
		UPDATE Bills SET unpaid = 1 WHERE Bills.id = @BillID
	END 
set @Status = 1
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RegisterAccount]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RegisterAccount] AS' 
END
GO
ALTER procedure [dbo].[RegisterAccount]
    @UserName nvarchar(255),
    @UserID nvarchar(255),
    @UserPWD nvarchar(255),
	@AdminAcc nvarchar(255),
	@ClientCardEditPerm nvarchar(255),
	@discountEditPerm nvarchar(255),
	@priceEditPerm nvarchar(255),
	@receiptEditPerm nvarchar(255),
	@inventoryEditPerm nvarchar(255),
	@expensesEditPerm nvarchar(255),
	@usersEditPerm nvarchar(255),
	@settingsEditPerm nvarchar(255),
	@personnelEditPerm nvarchar(255),
	@opencloseEditPerm nvarchar(255),
	@sellEditPerm nvarchar(255),
	@Status int OUTPUT
AS
BEGIN
	DECLARE @cnt INT = (SELECT COUNT(UID)FROM Users Where UID = @UserID)
	DECLARE @cnt2 INT = (SELECT COUNT(UID)FROM Users Where UID = @AdminAcc AND Authority = '1')
	IF @cnt < 1
	BEGIN
		if @cnt2 = 1
		BEGIN
			INSERT INTO Users(cashierName, UID, PWD)
			VALUES (@UserName, @UserID, @UserPWD)
			DECLARE @UID INT = (SELECT id FROM Users Where UID = @UserID)
			INSERT INTO UserPermissions(user_id, Client_card_perm, discount_perm, price_edit_perm, receipt_edit_perm, inventory_edit_perm, expense_add_perm, users_edit_perm, settings_edit_perm, personnel_edit_perm, openclose_edit_perm, sell_edit_perm) VALUES (@UID, @ClientCardEditPerm, @discountEditPerm, @priceEditPerm, @receiptEditPerm, @inventoryEditPerm, @expensesEditPerm, @usersEditPerm, @settingsEditPerm, @personnelEditPerm, @opencloseEditPerm, @sellEditPerm)
			set @Status = 1
		END
		Else
		Begin
			set @Status = 0
		End
	End
	Else
	BEGIN
		set @Status = 0
	End
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RegisterAdmin]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RegisterAdmin] AS' 
END
GO
ALTER procedure [dbo].[RegisterAdmin]
    @UserName nvarchar(255),
    @UserID nvarchar(255),
    @UserPWD nvarchar(255),
	@ClientCardEditPerm nvarchar(255),
	@discountEditPerm nvarchar(255),
	@priceEditPerm nvarchar(255),
	@receiptEditPerm nvarchar(255),
	@inventoryEditPerm nvarchar(255),
	@expensesEditPerm nvarchar(255),
	@usersEditPerm nvarchar(255),
	@settingsEditPerm nvarchar(255),
	@personnelEditPerm nvarchar(255),
	@opencloseEditPerm nvarchar(255),
	@sellEditPerm nvarchar(255),
	@Status int OUTPUT
AS
BEGIN
IF NOT EXISTS (SELECT * FROM Users 
		WHERE cashierName = @UserName and
		UID = @UserID and PWD = @UserPWD and Authority = '1')
		BEGIN
			INSERT INTO Users(cashierName, UID, PWD, Authority)
			VALUES (@UserName, @UserID, @UserPWD, '1')
			DECLARE @UID INT = (SELECT id FROM Users Where UID = @UserID)
			INSERT INTO UserPermissions(user_id, Client_card_perm, discount_perm, price_edit_perm, receipt_edit_perm, inventory_edit_perm, expense_add_perm, users_edit_perm, settings_edit_perm, personnel_edit_perm, openclose_edit_perm, sell_edit_perm) VALUES (@UID, @ClientCardEditPerm, @discountEditPerm, @priceEditPerm, @receiptEditPerm, @inventoryEditPerm, @expensesEditPerm, @usersEditPerm, @settingsEditPerm, @personnelEditPerm, @opencloseEditPerm, @sellEditPerm)
			set @Status = 1
		End
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RegisterClient]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RegisterClient] AS' 
END
GO
ALTER procedure [dbo].[RegisterClient]
    @ClientName nvarchar(255),
	@ClientPhone nvarchar(255),
	@ClientAddress nvarchar(255),
	@Status int OUTPUT
AS
BEGIN
    INSERT INTO ClientsVendors(ClientName, vendor, ClientPhone, ClientAddress) VALUES (@ClientName, 0, @ClientPhone, @ClientAddress)
set @Status = 1
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RegisterVendor]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RegisterVendor] AS' 
END
GO
ALTER procedure [dbo].[RegisterVendor]
    @ClientName nvarchar(255),
	@ClientPhone nvarchar(255),
	@ClientAddress nvarchar(255),
	@Status int OUTPUT
AS
BEGIN
    INSERT INTO ClientsVendors(ClientName, vendor, ClientPhone, ClientAddress) VALUES (@ClientName, 1, @ClientPhone, @ClientAddress)
set @Status = 1
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrieveAbsence]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrieveAbsence] AS' 
END
GO
ALTER procedure [dbo].[RetrieveAbsence]
	@Date1 date,
	@Date2 date
AS
BEGIN
    SELECT DISTINCT Absence.id as 'Absence ID', Employees.name as 'Employee Name', Absence.date as 'Absence Date', Absence.hours as 'Absence Hours' FROM Absence
	JOIN Employees ON Employees.id = Absence.emp_id
	WHERE Absence.date >= @Date1 AND Absence.date <= @Date2
	GROUP BY Absence.id, Employees.name, Absence.date, Absence.hours
	ORDER BY Absence.id, Employees.name, Absence.date, Absence.hours
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrieveAccountAuthority]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrieveAccountAuthority] AS' 
END
GO
ALTER procedure [dbo].[RetrieveAccountAuthority]
	@UserID nvarchar(255)
AS
BEGIN
	DECLARE @UID INT = (SELECT id FROM Users Where UID = @UserID)		
    SELECT TOP 1 Authority FROM Users WHERE id = @UID
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrieveBillItems]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrieveBillItems] AS' 
END
GO
ALTER procedure [dbo].[RetrieveBillItems]
	@BillNumber int
AS
BEGIN
    SELECT DISTINCT Items.ItemName as 'Item Name', Items.ItemBarCode as 'Item BarCode', BillItems.item_quantity as 'Times Sold', sum(BillItems.item_quantity) as 'Sold Quantity', Items.ItemPrice as 'Item Price', Items.ItemPriceTax as 'Item Price Tax' FROM BillItems
	INNER JOIN Items ON Items.ItemBarCode = Billitems.item_barcode
	LEFT JOIN TransactionItems ON TransactionItems.item_barcode = BillItems.item_barcode
	LEFT JOIN Transactions ON Transactions.id = TransactionItems.transaction_id AND Transactions.type = 0
	WHERE BillItems.bill_id = @BillNumber
	GROUP BY Items.ItemName, Items.ItemBarCode, BillItems.item_quantity, Items.ItemPrice, Items.ItemPriceTax
	ORDER by BillItems.item_quantity DESC
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrieveBillItemsProfit]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrieveBillItemsProfit] AS' 
END
GO
ALTER procedure [dbo].[RetrieveBillItemsProfit]
	@Date1 Datetime = NULL,
	@Date2 datetime = NULL,
	@ItemTypeID int = NULL,
	@cashierName nvarchar(255) = NULL
AS
BEGIN
    SELECT Items.ItemName as 'Item Name', Items.ItemBarCode as 'Item BarCode', ItemTypes.name as 'Item Type', Bills.cashierName as 'Cashier Name', Items.ItemPriceTax as 'Item Price Tax', sum(BillItems.item_quantity) as 'Times Sold', sum(Items.ItemPriceTax * BillItems.item_quantity) as 'Item Profit' FROM Items
	INNER JOIN BillItems ON 1=1
	INNER JOIN Bills ON BillItems.bill_id = Bills.id
	LEFT JOIN ItemTypes ON ItemTypes.id = Items.ItemType
	WHERE BillItems.item_barcode = Items.ItemBarCode AND (Bills.Date >= @Date1 AND Bills.Date <= @Date2) AND (@cashierName is NULL or Bills.cashierName = @cashierName) AND (@ItemTypeID is null or Items.ItemType = @ItemTypeID)
	GROUP BY Items.ItemBarCode, Items.ItemName, ItemTypes.name, Bills.cashierName, Items.ItemPriceTax ORDER by 'Times Sold', Bills.cashierName, ItemTypes.name DESC
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrieveBills]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrieveBills] AS' 
END
GO
ALTER procedure [dbo].[RetrieveBills]
AS
BEGIN
    SELECT id as 'Bill Number', cashierName as 'Cashier Name', totalAmount as 'Total Amount', paidAmount as 'Paid Amount', remainderAmount as 'Remainder Amount', 
	CASE paymentByCash WHEN 0 THEN 'Visa'
						WHEN 1 THEN 'Cash'
	End as 'Payment Type', date as 'Invoice Date' FROM Bills ORDER by id DESC
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrieveBillSoldBItemQuantity]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrieveBillSoldBItemQuantity] AS' 
END
GO
ALTER procedure [dbo].[RetrieveBillSoldBItemQuantity]
@BillNumber int,
@itemBarcode nvarchar(255),
@SoldItemQuantity int OUTPUT
AS
BEGIN
    Set  @SoldItemQuantity = (SELECT DISTINCT i.item_quantity FROM BILLS b LEFT JOIN BillItems i ON b.id = i.bill_id WHERE b.id = @BillNumber AND i.item_barcode = @itemBarcode)
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrieveCapitalRevenue]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrieveCapitalRevenue] AS' 
END
GO
ALTER procedure [dbo].[RetrieveCapitalRevenue]
AS
BEGIN
	SELECT Bills.Date as 'Date', sum((Items.ItemPriceTax - Items.ItemBuyPrice) * Items.ItemQuantity) as 'Total Revenue' FROM Items
	JOIN BillItems ON BillItems.item_barcode=Items.ItemBarCode
	JOIN Bills ON Billitems.bill_id = Bills.id GROUP BY Bills.Date ORDER BY Bills.Date DESC
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrieveCashierNames]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrieveCashierNames] AS' 
END
GO
ALTER procedure [dbo].[RetrieveCashierNames]
AS
BEGIN
    SELECT cashierName as 'Cashier Name' FROM Users
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrieveClientBills]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrieveClientBills] AS' 
END
GO
ALTER procedure [dbo].[RetrieveClientBills]
	@ClientID int
AS
BEGIN
    SELECT b.id as 'Bill Number', b.cashierName as 'Cashier Name', b.totalAmount as 'Total Amount', b.paidAmount as 'Paid Amount', b.remainderAmount as 'Remainder Amount', b.date as 'Date', CASE b.unpaid WHEN 0 THEN 'Paid'
						WHEN 1 THEN 'Unpaid'
	End as 'Status', b.ClientID, c.ClientName as 'Client ID' FROM Bills b
	RIGHT JOIN ClientsVendors c ON c.id = b.ClientID
	WHERE b.ClientID = @ClientID
	ORDER by b.id DESC
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrieveClientsList]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrieveClientsList] AS' 
END
GO
ALTER procedure [dbo].[RetrieveClientsList]
	@ClientName nvarchar(255) = NULL
AS
BEGIN
    SELECT ClientName as 'Client Name', ID as 'Client ID', ClientPhone as 'Client Phone', ClientAddress as 'Client Address' FROM ClientsVendors WHERE (@ClientName is null or ClientName LIKE '%' + @ClientName + '%') AND vendor = 0 ORDER by ClientName DESC
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrieveEmployees]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrieveEmployees] AS' 
END
GO
ALTER procedure [dbo].[RetrieveEmployees]
AS
BEGIN
	Declare @Date1 date
	Declare @Date2 date
	Set @Date1 = Dateadd(Day, -30, GETDATE())
	Set @Date2 = Dateadd(Day, 0, GetDATE())
    SELECT Employees.id as 'Employee ID', Employees.name as 'Employee Name', Employees.salary as 'Employee Salary', salary - sum(Deductions.deduction) as 'Deducted Salary', Employees.phone as 'Employee Phone', Employees.address as 'Employee Address' FROM Employees
	LEFT JOIN Deductions ON Deductions.emp_id = Employees.id AND Deductions.date >= @Date1 AND Deductions.date <= @Date2
	GROUP BY Employees.id, Employees.name, Employees.salary, Employees.phone, Employees.address
	ORDER by Employees.id, Employees.name DESC
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrieveExpireStockToday]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrieveExpireStockToday] AS' 
END
GO
ALTER procedure [dbo].[RetrieveExpireStockToday]
	@Date1 Datetime = NULL,
	@Date2 datetime = NULL,
	@ItemBarCode nvarchar(255) = NULL,
	@CurrentQuantity int = 0
AS
BEGIN
set @Date1 = DATEADD(Day, -1, @Date1)
set @Date2 = DATEADD(Day, 1, @Date2)
SELECT TOP 1 ItemName as 'Item Name', ItemBarCode as 'Item BarCode', ProductionDate as 'Start Date', ExpirationDate as 'End Date', QuantityWarning as 'Quantity End', ItemQuantity as 'Current Quantity' FROM Items WHERE ((ExpirationDate <= @Date1) OR (QuantityWarning > @CurrentQuantity)) and ItemBarCode = @ItemBarCode ORDER by id DESC
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrieveExports]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrieveExports] AS' 
END
GO
ALTER procedure [dbo].[RetrieveExports]
AS
BEGIN
	SELECT Items.Date as 'Date', sum(Items.ItemPriceTax * Items.ItemQuantity) as 'Total Cost' FROM Items
	JOIN BillItems ON BillItems.item_barcode=Items.ItemBarCode GROUP BY Date ORDER BY Items.Date DESC
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrieveFavoriteCategories]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrieveFavoriteCategories] AS' 
END
GO
ALTER procedure [dbo].[RetrieveFavoriteCategories]
AS
BEGIN
    SELECT id as 'Category ID', name as 'Category Name' FROM FavoriteCategories ORDER by id ASC
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrieveFavoriteCategoryIndex]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrieveFavoriteCategoryIndex] AS' 
END
GO
ALTER procedure [dbo].[RetrieveFavoriteCategoryIndex]
@CategoryName nvarchar(255)
AS
BEGIN
    SELECT TOP 1 id as 'Category ID' FROM FavoriteCategories WHERE name = @CategoryName
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrieveFavoriteCategoryName]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrieveFavoriteCategoryName] AS' 
END
GO
ALTER procedure [dbo].[RetrieveFavoriteCategoryName]
@CategoryIndex nvarchar(255)
AS
BEGIN
    SELECT TOP 1 CASE WHEN name IS NULL THEN N'غير مفضله' ELSE name END as 'Category Name' FROM FavoriteCategories WHERE id = @CategoryIndex
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrieveFavoriteItems]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrieveFavoriteItems] AS' 
END
GO
ALTER procedure [dbo].[RetrieveFavoriteItems]
	@Category int = NULL
AS
BEGIN
    SELECT id as 'Item ID', ItemName as 'Item Name', ItemBarCode as 'Item BarCode', ItemQuantity as 'Item Quantity', ItemPrice as 'Item Price', ItemPriceTax as 'Item Price Tax', Favorite as 'Favorite Category' FROM Items WHERE Favorite = @Category ORDER by id DESC
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrieveImports]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrieveImports] AS' 
END
GO
ALTER procedure [dbo].[RetrieveImports]
AS
BEGIN
    SELECT Items.Date as 'Date', sum(Items.ItemPriceTax * Items.ItemQuantity) as 'Total Cost' FROM Items GROUP BY Date ORDER BY Items.Date DESC
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrieveItemPictureFromBarCode]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrieveItemPictureFromBarCode] AS' 
END
GO
ALTER procedure [dbo].[RetrieveItemPictureFromBarCode]
	@ItemBarCode nvarchar(255) = NULL
AS
BEGIN
    SELECT TOP 1 Picture as 'Item Picture' FROM Items WHERE ItemBarCode = @ItemBarCode ORDER by id DESC
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrieveItems]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrieveItems] AS' 
END
GO
ALTER procedure [dbo].[RetrieveItems]
	@Locale int = 1
AS
BEGIN
	if @Locale = 0
		SELECT I.ID as 'Item ID', ItemName as 'Item Name', ItemBarCode as 'Item BarCode', ItemQuantity as 'Item Quantity', ItemBuyPrice as 'Item Buy Price', ItemPrice as 'Item Price', ItemPriceTax as 'Item Price Tax', Favorite as 'Favorite Category Number', CASE WHEN F.name IS NULL THEN N'غير مفضله' ELSE F.name END as 'Favorite Category', Warehouse_id as 'Warehouse ID', CASE WHEN W.name IS NULL THEN N'غير موجود' ELSE W.name END as 'InventoryItemWarehouse', ItemType as 'Item Type', CASE WHEN T.name IS NULL THEN N'غير مصنف' ELSE T.name END as 'InventoryItemType', Picture as 'Item Picture'
		FROM Items I
		LEFT JOIN FavoriteCategories f ON f.id = I.Favorite
		LEFT JOIN Warehouses w ON w.id = I.Warehouse_id
		LEFT JOIN ItemTypes T ON T.id = I.ItemType
		ORDER by I.id DESC
	else if @Locale = 1
		SELECT I.ID as 'Item ID', ItemName as 'Item Name', ItemBarCode as 'Item BarCode', ItemQuantity as 'Item Quantity', ItemBuyPrice as 'Item Buy Price', ItemPrice as 'Item Price', ItemPriceTax as 'Item Price Tax', Favorite as 'Favorite Category Number', CASE WHEN F.name IS NULL THEN N'Not Favorited' ELSE F.name END as 'Favorite Category', Warehouse_id as 'Warehouse ID', CASE WHEN W.name IS NULL THEN N'Inexistent' ELSE W.name END as 'InventoryItemWarehouse', ItemType as 'Item Type', CASE WHEN T.name IS NULL THEN N'Unclassified' ELSE T.name END as 'InventoryItemType', Picture as 'Item Picture'
		FROM Items I
		LEFT JOIN FavoriteCategories f ON f.id = I.Favorite
		LEFT JOIN Warehouses w ON w.id = I.Warehouse_id
		LEFT JOIN ItemTypes T ON T.id = I.ItemType
		ORDER by I.id DESC
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrieveItemsQuantity]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrieveItemsQuantity] AS' 
END
GO
ALTER procedure [dbo].[RetrieveItemsQuantity]
	@ItemBarCode nvarchar(255) = ''
AS
BEGIN
	if @ItemBarCode = ''
		begin
			SELECT ItemBarCode as 'Item BarCode', ItemQuantity as 'Item Quantity' FROM Items
			GROUP BY id, ItemBarCode, ItemQuantity
			ORDER BY id
		end
	else
		begin
			SELECT ItemBarCode as 'Item BarCode', ItemQuantity as 'Item Quantity' FROM Items
			WHERE ItemBarCode = @ItemBarCode
			GROUP BY id, ItemBarCode, ItemQuantity
			ORDER BY id
		end
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrieveItemsQuantityDates]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrieveItemsQuantityDates] AS' 
END
GO
ALTER procedure [dbo].[RetrieveItemsQuantityDates]
	@ItemBarCode nvarchar(255) = NULL
AS
BEGIN
    SELECT TOP 1 ItemName as 'Item Name', ItemBarCode as 'Item BarCode', ItemQuantity as 'Item Quantity', QuantityWarning as 'Quantity Warning', ProductionDate as 'Production Date', ExpirationDate as 'Expiration Date', EntryDate as 'Entry Date' FROM Items WHERE ItemBarCode = @ItemBarCode ORDER by id DESC
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrieveItemTypeIndex]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrieveItemTypeIndex] AS' 
END
GO
ALTER procedure [dbo].[RetrieveItemTypeIndex]
@ItemTypeName nvarchar(255)
AS
BEGIN
    SELECT TOP 1 id as 'ItemType ID' FROM ItemTypes WHERE name = @ItemTypeName
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrieveItemTypeName]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrieveItemTypeName] AS' 
END
GO
ALTER procedure [dbo].[RetrieveItemTypeName]
@ItemTypeIndex nvarchar(255)
AS
BEGIN
    SELECT TOP 1 CASE WHEN name IS NULL THEN N'غير مصنف' ELSE name END as 'ItemType Name' FROM ItemTypes WHERE id = @ItemTypeIndex
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrieveItemTypes]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrieveItemTypes] AS' 
END
GO
ALTER procedure [dbo].[RetrieveItemTypes]
AS
BEGIN
    SELECT id as 'ItemType ID', name as 'ItemType Name' FROM ItemTypes ORDER by id ASC
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrieveLastBillNumber]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrieveLastBillNumber] AS' 
END
GO
ALTER procedure [dbo].[RetrieveLastBillNumber]
AS
BEGIN
SELECT TOP 1 id as 'Bill Number' FROM Bills ORDER by id DESC
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrieveLastBillNumberByDates]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrieveLastBillNumberByDates] AS' 
END
GO
ALTER procedure [dbo].[RetrieveLastBillNumberByDates]
	@Date1 Datetime = NULL,
	@Date2 datetime = NULL
AS
set @Date1 = DATEADD(Day, -1, @Date1)
set @Date2 = DATEADD(Day, 1, @Date2)
BEGIN
SELECT TOP 1 id as 'Bill Number' FROM Bills WHERE ( Date >= @Date1 AND Date <= @Date2) ORDER by id DESC
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrieveLastVendorBillNumberToday]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrieveLastVendorBillNumberToday] AS' 
END
GO
ALTER procedure [dbo].[RetrieveLastVendorBillNumberToday]
	@Date1 Datetime = NULL,
	@Date2 datetime = NULL
AS
set @Date1 = DATEADD(Day, -1, @Date1)
set @Date2 = DATEADD(Day, 1, @Date2)
BEGIN
SELECT TOP 1 id as 'Bill Number' FROM VendorBills WHERE ( Date >= @Date1 AND Date <= @Date2) ORDER by id DESC
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrieveLeastBoughtItems]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrieveLeastBoughtItems] AS' 
END
GO
ALTER procedure [dbo].[RetrieveLeastBoughtItems]
AS
BEGIN
	
    SELECT TOP 100 Items.ItemName as 'Item Name', Items.ItemBarCode as 'Item BarCode', sum(BillItems.item_quantity) as 'Times Sold', Items.ItemPrice as 'Item Price', Items.ItemPriceTax as 'Item Price Tax' FROM Items
	JOIN BillItems ON Items.ItemBarCode = BillItems.item_barcode GROUP BY Items.ItemBarCode, Items.ItemName, Items.ItemPrice, Items.ItemPriceTax ORDER BY 'Times Sold' ASC
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrieveLoginLogoutInfo]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrieveLoginLogoutInfo] AS' 
END
GO
ALTER procedure [dbo].[RetrieveLoginLogoutInfo]
	@Date1 Datetime = NULL,
	@Date2 datetime = NULL
AS
BEGIN
set @Date1 = DATEADD(Day, -1, @Date1)
set @Date2 = DATEADD(Day, 1, @Date2)
    SELECT cashierName as 'Cashier Name', date as 'Date', action as 'Action' FROM LoginLogout
	WHERE ( Date >= @Date1 AND Date <= @Date2) ORDER BY id DESC
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrieveMostBoughtItems]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrieveMostBoughtItems] AS' 
END
GO
ALTER procedure [dbo].[RetrieveMostBoughtItems]
AS
BEGIN
	
    SELECT TOP 100 Items.ItemName as 'Item Name', Items.ItemBarCode as 'Item BarCode', sum(BillItems.item_quantity) as 'Times Sold', Items.ItemPrice as 'Item Price', Items.ItemPriceTax as 'Item Price Tax' FROM Items
	JOIN BillItems ON Items.ItemBarCode = BillItems.item_barcode GROUP BY Items.ItemBarCode, Items.ItemName, Items.ItemPrice, Items.ItemPriceTax ORDER BY 'Times Sold' DESC
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrievePortedBills]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrievePortedBills] AS' 
END
GO
ALTER procedure [dbo].[RetrievePortedBills]
AS
BEGIN
    SELECT id as 'Bill Number', cashierName as 'Cashier Name', totalAmount as 'Total Amount', paidAmount as 'Paid Amount', remainderAmount as 'Remainder Amount', CASE paymentByCash WHEN 0 THEN 'Visa'
						WHEN 1 THEN 'Cash'
	End as 'Payment Type', '' as 'TotalPorted'  FROM Bills WHERE ported = 1 ORDER by id DESC
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrievePrinterItemTypes]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrievePrinterItemTypes] AS' 
END
GO
ALTER procedure [dbo].[RetrievePrinterItemTypes]
	@printerID int
AS
BEGIN
    SELECT P.itemTypeID as 'ItemType ID', I.name as 'ItemType Name' FROM PrinterItemType P
	LEFT JOIN ItemTypes I ON I.id = P.itemTypeID
	WHERE printerID = @printerID 
	ORDER by P.id ASC
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrievePrinters]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrievePrinters] AS' 
END
GO
ALTER procedure [dbo].[RetrievePrinters]
	@machineName nvarchar(255)
AS
BEGIN
    SELECT id as 'Printer ID', printerName as 'Printer Name' FROM Printers WHERE machineName = @machineName ORDER by id ASC
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrieveReturnedItems]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrieveReturnedItems] AS' 
END
GO
ALTER procedure [dbo].[RetrieveReturnedItems]
AS
BEGIN
	Declare @TransactionID int
	SELECT TransactionItems.transaction_id as 'Transaction ID', Transactions.cashierName as 'Cashier Name', Items.ItemName as 'Item Name', TransactionItems.item_barcode as 'Item BarCode', TransactionItems.item_quantity as 'Item Quantity' FROM TransactionItems
	INNER JOIN Transactions ON Transactions.id = TransactionItems.transaction_id AND Transactions.type = 2
	INNER JOIN Items ON Items.ItemBarCode = TransactionItems.item_barcode
	WHERE TransactionItems.transaction_id = Transactions.id
	ORDER BY TransactionItems.id
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrieveSale]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrieveSale] AS' 
END
GO
ALTER procedure [dbo].[RetrieveSale]
	@Date1 Datetime = NULL,
	@Date2 datetime = NULL,
	@QuantityEnd int = 0
AS
BEGIN
set @Date1 = DATEADD(Day, -1, @Date1)
set @Date2 = DATEADD(Day, 1, @Date2)
SELECT TOP 1 id as 'Sale ID', item_barcode as 'Item BarCode', sale_rate as 'Sale Rate', start_date as 'Start Date', end_date as 'End Date', quantity_end as 'Quantity End' FROM Discounts WHERE ((start_date <= @Date2 AND end_date >= @Date1) AND (quantity_end > 0)) ORDER by id DESC
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrieveSaleItemsQuantity]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrieveSaleItemsQuantity] AS' 
END
GO
ALTER procedure [dbo].[RetrieveSaleItemsQuantity]
AS
BEGIN
SELECT Discounts.id as 'Sale ID', Discounts.item_barcode as 'Item BarCode', Items.ItemQuantity as 'Quantity End' FROM Discounts
JOIN Items ON Items.ItemBarCode = Discounts.item_barcode
GROUP BY Discounts.id, Discounts.item_barcode, Items.ItemQuantity
ORDER by Discounts.id DESC
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrieveSystemSettings]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrieveSystemSettings] AS' 
END
GO
ALTER procedure [dbo].[RetrieveSystemSettings]
AS
BEGIN
    SELECT TOP 1 * FROM Settings WHERE id = 1
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrieveTaxZReport]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrieveTaxZReport] AS' 
END
GO
ALTER procedure [dbo].[RetrieveTaxZReport]
AS
BEGIN
    SELECT bills.id as 'Bill Number', cashierName as 'Cashier Name', totalAmount as 'Total Amount', sum(items.ItemPriceTax - items.ItemPrice)  as 'Tax', bills.date as 'Date', '' as 'TaxTotal' FROM Bills
inner join billitems on bills.id = billitems.bill_id
inner join items on billitems.item_barcode = items.ItemBarCode
group by Bills.id, bills.cashierName, bills.totalAmount, bills.date
ORDER by bills.id DESC
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrieveUnpaidBills]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrieveUnpaidBills] AS' 
END
GO
ALTER procedure [dbo].[RetrieveUnpaidBills]
AS
BEGIN
    SELECT id as 'Bill Number', cashierName as 'Cashier Name', date as 'Date', totalAmount as 'Total Amount', paidAmount as 'Paid Amount', remainderAmount as 'Remainder Amount', 
	CASE paymentByCash WHEN 0 THEN 'Visa'
						WHEN 1 THEN 'Cash'
	End as 'Payment Type', date as 'Invoice Date' FROM Bills WHERE unpaid = 1 ORDER by id DESC
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrieveUnPortedBills]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrieveUnPortedBills] AS' 
END
GO
ALTER procedure [dbo].[RetrieveUnPortedBills]
AS
BEGIN
    SELECT id as 'Bill Number', cashierName as 'Cashier Name', totalAmount as 'Total Amount', paidAmount as 'Paid Amount', remainderAmount as 'Remainder Amount', CASE paymentByCash WHEN 0 THEN 'Visa'
						WHEN 1 THEN 'Cash'
	End as 'Payment Type', '' as 'TotalUnPorted'  FROM Bills WHERE ported = 0 ORDER by id DESC
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrieveUserPermissions]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrieveUserPermissions] AS' 
END
GO
ALTER procedure [dbo].[RetrieveUserPermissions]
	@UserID nvarchar(255)
AS
BEGIN
	DECLARE @UID INT = (SELECT id FROM Users Where UID = @UserID)		
    SELECT TOP 1 Client_card_perm as 'Client Card Permission', discount_perm as 'Discount Permission', price_edit_perm as 'Price Edit Permission', receipt_edit_perm as 'Receipt Edit Permission', inventory_edit_perm as 'Inventory Edit Permission', expense_add_perm as 'Expense Add Permission', users_edit_perm as 'Users Edit Permission', settings_edit_perm as 'Settings Edit Permission', personnel_edit_perm as 'Personnel Edit Permission', openclose_edit_perm as 'Open Close Cash Permission', sell_edit_perm as 'Sell Permission' FROM UserPermissions WHERE user_id = @UID
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrieveUsers]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrieveUsers] AS' 
END
GO
ALTER procedure [dbo].[RetrieveUsers]
AS
BEGIN
    SELECT cashierName as 'User Name', UID as 'User ID', PWD as 'User Password', Authority as 'User Authority' FROM Users ORDER by Authority, id DESC
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrieveUsersList]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrieveUsersList] AS' 
END
GO
ALTER procedure [dbo].[RetrieveUsersList]
AS
BEGIN
    SELECT cashierName as 'User Name', UID as 'User ID' FROM Users ORDER by Authority, id DESC
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrieveVendorBillItems]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrieveVendorBillItems] AS' 
END
GO
ALTER procedure [dbo].[RetrieveVendorBillItems]
	@BillNumber int
AS
BEGIN
    SELECT DISTINCT Items.ItemName as 'Item Name', Items.ItemBarCode as 'Item BarCode', VendorBillItems.item_quantity as 'Item Buy Quantity', Items.ItemBuyPrice as 'Item Buy Price' FROM Items
	JOIN VendorBillItems ON VendorBillItems.bill_id = @BillNumber ORDER BY Items.ItemName
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrieveVendorBills]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrieveVendorBills] AS' 
END
GO
ALTER procedure [dbo].[RetrieveVendorBills]
AS
BEGIN
    SELECT id as 'Bill Number', cashierName as 'Cashier Name', totalAmount as 'Total Amount', date as 'Date' FROM VendorBills WHERE unpaid = 0 ORDER by id DESC
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrieveVendorsList]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrieveVendorsList] AS' 
END
GO
ALTER procedure [dbo].[RetrieveVendorsList]
	@ClientName nvarchar(255) = NULL
AS
BEGIN
    SELECT ClientName as 'Client Name', ID as 'Client ID', ClientPhone as 'Client Phone', ClientAddress as 'Client Address' FROM ClientsVendors WHERE (@ClientName is null or ClientName LIKE '%' + @ClientName + '%') AND vendor = 1 ORDER by ClientName DESC
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrieveWarehouseIndex]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrieveWarehouseIndex] AS' 
END
GO
ALTER procedure [dbo].[RetrieveWarehouseIndex]
@WarehouseName nvarchar(255)
AS
BEGIN
    SELECT TOP 1 id as 'Warehouse ID' FROM Warehouses WHERE name = @WarehouseName
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrieveWarehouseName]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrieveWarehouseName] AS' 
END
GO
ALTER procedure [dbo].[RetrieveWarehouseName]
@WarehouseIndex nvarchar(255)
AS
BEGIN
    SELECT TOP 1 CASE WHEN name IS NULL THEN N'غير موجود' ELSE name END as 'Warehouse Name' FROM Warehouses WHERE id = @WarehouseIndex
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RetrieveWarehouses]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[RetrieveWarehouses] AS' 
END
GO
ALTER procedure [dbo].[RetrieveWarehouses]
AS
BEGIN
    SELECT id as 'Warehouse ID', name as 'Warehouse Name' FROM Warehouses ORDER by id ASC
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ReturnItem]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[ReturnItem] AS' 
END
GO
ALTER procedure [dbo].[ReturnItem]
	@ItemName nvarchar(255),
	@ItemBarCode nvarchar(255),
	@ItemQuantity int,
	@cashierName nvarchar(255),
	@Date date,
	@Status int OUTPUT
AS
BEGIN
	UPDATE Items SET ItemQuantity = @ItemQuantity WHERE ItemBarCode = @ItemBarCode AND ItemName = @ItemName
	INSERT INTO Transactions(cashierName, date, type, time) VALUES (@cashierName, @Date, 2, convert(time, getdate(), 108))
	Declare @TransactionID int
	set @TransactionID = (SELECT TOP 1 id FROM Transactions WHERE cashierName = @cashierName AND date = @Date AND type = 2 ORDER BY id DESC)
	Declare @oldquantity int = (SELECT ItemQuantity FROM Items WHERE ItemBarCode = @ItemBarCode AND ItemName = @ItemName)
	Set @oldquantity = @oldquantity + @ItemQuantity
	UPDATE Items Set ItemQuantity = @oldquantity, Date = @Date WHERE ItemBarCode = @ItemBarCode and ItemName = @ItemName
	INSERT INTO TransactionItems(item_barcode, item_quantity, transaction_id) VALUES (@ItemBarCode, @ItemQuantity, @TransactionID)
set @Status = 1
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SaveRegisterClose]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[SaveRegisterClose] AS' 
END
GO
ALTER procedure [dbo].[SaveRegisterClose]
@cashier_name nvarchar(255),
@moneyInRegister decimal,
@date datetime,
@Date1 Date = NULL,
@Date2 Date = NULL,
@Status int OUTPUT
AS
BEGIN
set @Date1 = DATEADD(Day, -1, @date)
set @Date2 = DATEADD(Day, 1, @date)
    INSERT RegisterHistory(cashier_name, moneyInRegister, date, openorclose) VALUES (@cashier_name, @moneyInRegister, @date, 0)
	UPDATE Bills SET ported = 1 WHERE (date >= @Date1 AND date <= @Date2) or ported = 0
set @Status = 1
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SaveRegisterOpen]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[SaveRegisterOpen] AS' 
END
GO
ALTER procedure [dbo].[SaveRegisterOpen]
@cashier_name nvarchar(255),
@moneyInRegister decimal,
@date datetime,
@Status int OUTPUT
AS
BEGIN
    INSERT RegisterHistory(cashier_name, moneyInRegister, date, openorclose) VALUES (@cashier_name, @moneyInRegister, @date, 1)
set @Status = 1
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SearchBills]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[SearchBills] AS' 
END
GO
ALTER procedure [dbo].[SearchBills]
	@BillNumber int
AS
BEGIN
SELECT b.id as 'Bill Number', b.cashierName as 'Cashier Name', b.totalAmount as 'Total Amount', b.paidAmount as 'Paid Amount', b.remainderAmount as 'Remainder Amount', 
	CASE b.paymentByCash WHEN 0 THEN 'Visa'
						WHEN 1 THEN 'Cash'
	End as 'Payment Type', b.date as 'Invoice Date', c.ClientName as 'Client Name', c.ClientPhone as 'Client Phone', c.ClientAddress as 'Client Address' FROM Bills b
	LEFT JOIN ClientsVendors c ON c.id = b.ClientID
	WHERE b.id = @BillNumber ORDER by b.id DESC
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SearchClients]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[SearchClients] AS' 
END
GO
ALTER procedure [dbo].[SearchClients]
	@ClientName nvarchar(255) = NULL,
	@ClientID int = 0,
	@itemBarCode nvarchar(255) = NULL
AS
BEGIN
select ClientsVendors.ClientName as 'Client Name', ClientsVendors.ID as 'Client ID', Items.ItemName as 'Item Name', Items.ItemBarCode as 'Item BarCode', ClientsItems.item_price as 'Client Price' From ClientsVendors
LEFT JOIN ClientsItems ON ClientsItems.Client_id = ClientsVendors.ID
LEFT JOIN Items ON Items.ItemBarCode = ClientsItems.item_barcode
where (@ClientName is null or ClientsVendors.ClientName LIKE '%' + @ClientName + '%') or (@ClientID is null or ClientsVendors.ID = @ClientID) or (@itemBarCode is null or ClientsItems.item_barcode LIKE '%' + @itemBarCode + '%') and vendor = 0
GROUP BY ClientsVendors.id, ClientsVendors.ClientName, ClientsVendors.ID, Items.ItemName, Items.ItemBarCode, ClientsItems.item_price
Order by ClientsVendors.id DESC
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SearchClientsInfo]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[SearchClientsInfo] AS' 
END
GO
ALTER procedure [dbo].[SearchClientsInfo]
	@ClientName nvarchar(255) = NULL,
	@ClientID nvarchar(255) = NULL
AS
BEGIN
select ClientsVendors.id as 'Client ID', ClientsVendors.ClientName as 'Client Name' From ClientsVendors
where (@ClientName is null or ClientsVendors.ClientName LIKE '%' + @ClientName + '%') and (@ClientID is null or ClientsVendors.ID LIKE '%' + @ClientID + '%')
Order by ClientsVendors.id DESC
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SearchExpenses]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[SearchExpenses] AS' 
END
GO
ALTER procedure [dbo].[SearchExpenses]
	@ExpenseName nvarchar(255) = NULL,
	@EmployeeID nvarchar(255) = NULL,
	@Date1 Datetime = NULL,
	@Date2 datetime = NULL
AS
BEGIN
set @Date1 = DATEADD(Day, -1, @Date1)
select id as 'Expense ID', name as 'Expense Name', employee_id as 'Employee ID', sum(cost) as 'Expense Cost', date as 'Expense Date' From Expenses where 
(@ExpenseName is null or name LIKE '%' + @ExpenseName + '%') and ( @EmployeeID is null or employee_id LIKE '%' + @EmployeeID + '%') and ( date >= @Date1 AND date <= @Date2)
Group by id, name, date, employee_id
Order by date DESC
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SearchInventoryItems]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[SearchInventoryItems] AS' 
END
GO
ALTER procedure [dbo].[SearchInventoryItems]
	@ItemName nvarchar(255) = NULL,
	@ItemBarCode nvarchar(255) = NULL,
	@Locale int = 1
AS
BEGIN

if @Locale = 0
SELECT I.ID as 'Item ID', ItemName as 'Item Name', ItemBarCode as 'Item BarCode', ItemQuantity as 'Item Quantity', ItemBuyPrice as 'Item Buy Price', ItemPrice as 'Item Price', ItemPriceTax as 'Item Price Tax', Favorite as 'Favorite Category Number', CASE WHEN F.name IS NULL THEN N'غير مفضله' ELSE F.name END as 'Favorite Category', Warehouse_id as 'Warehouse ID', CASE WHEN W.name IS NULL THEN N'غير موجود' ELSE W.name END as 'InventoryItemWarehouse', ItemType as 'Item Type', CASE WHEN T.name IS NULL THEN N'غير مصنف' ELSE T.name END as 'InventoryItemType', Picture as 'Item Picture'
FROM Items I
		LEFT JOIN FavoriteCategories f ON f.id = I.Favorite
		LEFT JOIN Warehouses w ON w.id = I.Warehouse_id
		LEFT JOIN ItemTypes T ON T.id = I.ItemType
		WHERE (@ItemName is null or ItemName LIKE '%' + @ItemName + '%') and ( @ItemBarCode is null or ItemBarCode LIKE '%' + @ItemBarCode + '%')
		ORDER by I.id DESC
	else if @Locale = 1
	SELECT I.ID as 'Item ID', ItemName as 'Item Name', ItemBarCode as 'Item BarCode', ItemQuantity as 'Item Quantity', ItemBuyPrice as 'Item Buy Price', ItemPrice as 'Item Price', ItemPriceTax as 'Item Price Tax', Favorite as 'Favorite Category Number', CASE WHEN F.name IS NULL THEN N'Not Favorited' ELSE F.name END as 'Favorite Category', Warehouse_id as 'Warehouse ID', CASE WHEN W.name IS NULL THEN N'Inexistent' ELSE W.name END as 'InventoryItemWarehouse', ItemType as 'Item Type', CASE WHEN T.name IS NULL THEN N'Unclassified' ELSE T.name END as 'InventoryItemType', Picture as 'Item Picture'
FROM Items I
		LEFT JOIN FavoriteCategories f ON f.id = I.Favorite
		LEFT JOIN Warehouses w ON w.id = I.Warehouse_id
		LEFT JOIN ItemTypes T ON T.id = I.ItemType
		WHERE (@ItemName is null or ItemName LIKE '%' + @ItemName + '%') and ( @ItemBarCode is null or ItemBarCode LIKE '%' + @ItemBarCode + '%')
		ORDER by I.id DESC

END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SearchInventoryItemsWithBarCode]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[SearchInventoryItemsWithBarCode] AS' 
END
GO
ALTER procedure [dbo].[SearchInventoryItemsWithBarCode]
	@ItemBarCode nvarchar(255)
AS
BEGIN
SELECT id as 'Item ID', ItemName as 'Item Name', ItemBarCode as 'Item BarCode', ItemQuantity as 'Item Quantity', ItemBuyPrice as 'Item Buy Price', ItemPrice as 'Item Price', ItemPriceTax as 'Item Price Tax', Favorite as 'Favorite Category', Warehouse_id as 'Warehouse ID', ItemType as 'Item Type', Picture as 'Picture' FROM Items where 
ItemBarCode = @ItemBarCode
Order by id DESC
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SearchItems]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[SearchItems] AS' 
END
GO
ALTER procedure [dbo].[SearchItems]
	@ItemName nvarchar(255) = NULL,
	@ItemBarCode nvarchar(255) = NULL,
	@ItemType nvarchar(255) = NULL
AS
BEGIN
SELECT I.ID as 'Item ID', I.ItemName as 'Item Name', I.ItemBarCode as 'Item BarCode', I.ItemQuantity as 'Item Quantity', I.ItemBuyPrice as 'Item Buy Price', I.ItemPrice as 'Item Price', I.ItemPriceTax as 'Item Price Tax', I.Favorite as 'Favorite Category Number', CASE WHEN F.name IS NULL THEN N'غير مفضله' ELSE F.name END as 'Favorite Category', I.Warehouse_id as 'Warehouse ID', CASE WHEN W.name IS NULL THEN N'غير موجود' ELSE W.name END as 'InventoryItemWarehouse', I.ItemType as 'Item Type', CASE WHEN T.name IS NULL THEN N'غير مصنف' ELSE T.name END as 'InventoryItemType'
FROM Items I
LEFT JOIN FavoriteCategories f ON f.id = I.Favorite
	LEFT JOIN Warehouses w ON w.id = I.Warehouse_id
	LEFT JOIN ItemTypes T ON T.id = I.ItemType
	where 
(@ItemName is null or ItemName LIKE '%' + @ItemName + '%') and ( @ItemBarCode is null or ItemBarCode LIKE '%' + @ItemBarCode + '%') and ( @ItemType is null or ItemType LIKE '%' + @ItemType + '%')
	ORDER by I.id DESC
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SearchItemsQuantity]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[SearchItemsQuantity] AS' 
END
GO
ALTER procedure [dbo].[SearchItemsQuantity]
	@ItemBarCode nvarchar(255) = NULL
AS
BEGIN
SELECT ItemName as 'Item Name', ItemBarCode as 'Item BarCode', ItemQuantity as 'Item Quantity', ItemBuyPrice as 'Item Buy Price', ItemPrice as 'Item Price', ItemPriceTax as 'Item Price Tax', Favorite as 'Favorite Category', Warehouse_id as 'Warehouse ID', ItemType as 'Item Type' FROM Items where 
( @ItemBarCode is null or ItemBarCode =  @ItemBarCode )
Order by id DESC
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SearchTodayBills]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[SearchTodayBills] AS' 
END
GO
ALTER procedure [dbo].[SearchTodayBills]
	@Date1 Datetime = NULL,
	@Date2 datetime = NULL
AS
BEGIN
set @Date1 = DATEADD(Day, -1, @Date1)
set @Date2 = DATEADD(Day, 1, @Date2)
SELECT id as 'Bill Number', cashierName as 'Cashier Name', totalAmount as 'Total Amount', paidAmount as 'Paid Amount', remainderAmount as 'Remainder Amount', date as 'Date' FROM Bills WHERE ( Date >= @Date1 AND Date <= @Date2) ORDER by id DESC
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SearchWarehouseInventoryItems]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[SearchWarehouseInventoryItems] AS' 
END
GO
ALTER procedure [dbo].[SearchWarehouseInventoryItems]
	@WarehouseID int = 0
AS
BEGIN
SELECT ItemName as 'Item Name', ItemBarCode as 'Item BarCode', ItemQuantity as 'Item Quantity', ItemBuyPrice as 'Item Buy Price', ItemPrice as 'Item Price', ItemPriceTax as 'Item Price Tax', Favorite as 'Favorite Category', Warehouse_id as 'Warehouse ID', ItemType as 'Item Type' FROM Items where 
(Warehouse_id = @WarehouseID)
Order by id DESC
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[UpdateBill]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[UpdateBill] AS' 
END
GO
ALTER procedure [dbo].[UpdateBill]
@BillNumber int,
@CashierName nvarchar(255),
@TotalAmount decimal(18,2),
@PaidAmount decimal(18,2),
@RemainderAmount decimal(18,2),
	@Status int OUTPUT
AS
BEGIN
    UPDATE Bills Set cashierName = @CashierName, totalAmount = @TotalAmount, paidAmount = @PaidAmount, remainderAmount = @RemainderAmount WHERE Bills.id = @BillNumber
set @Status = 1
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[UpdateEmployee]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[UpdateEmployee] AS' 
END
GO
ALTER procedure [dbo].[UpdateEmployee]
	@EmployeeID int,
	@EmployeeName nvarchar(255),
	@Salary decimal(18, 2),
	@Phone nvarchar(255),
	@Address nvarchar(255),
	@Status int OUTPUT
AS
BEGIN
    UPDATE Employees Set name = @EmployeeName, salary = @Salary, phone = @Phone, address = @Address WHERE id = @EmployeeID
set @Status = 1
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[UpdateFavoriteCategory]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[UpdateFavoriteCategory] AS' 
END
GO
ALTER procedure [dbo].[UpdateFavoriteCategory]
	@CategoryID int,
	@CategoryName nvarchar(255) = NULL,
	@Status int OUTPUT
AS
BEGIN
    UPDATE FavoriteCategories SET name = @CategoryName WHERE id = @CategoryID
set @Status = 1
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[UpdateItem]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[UpdateItem] AS' 
END
GO
ALTER procedure [dbo].[UpdateItem]
	@ItemName nvarchar(255),
	@ItemBarCode nvarchar(255),
	@ItemNewBarCode nvarchar(255),
	@ItemQuantity int,
	@ItemBuyPrice decimal(18, 2),
	@ItemPrice decimal(18, 2),
	@ItemPriceTax decimal(18, 2),
	@ItemTypeID nvarchar(255),
	@WarehouseID nvarchar(255),
	@Favorite nvarchar(255),
	@Date Date,
	@Picture varbinary(MAX) = NULL,
	@WarningQuantity int = 0,
	@ProductionDate date = NULL,
	@ExpirationDate date = NULL,
	@EntryDate date = NULL,
	@Status int OUTPUT
AS
BEGIN
    UPDATE Items Set ItemName = @ItemName, ItemBarCode = @ItemNewBarCode, ItemQuantity = @ItemQuantity, ItemBuyPrice = @ItemBuyPrice, ItemPrice = @ItemPrice, ItemPriceTax = @ItemPriceTax, Warehouse_id = @WarehouseID, ItemType = @ItemTypeID, Favorite = @Favorite, Date = @Date, Picture = @Picture, QuantityWarning = @WarningQuantity, ProductionDate = @ProductionDate, ExpirationDate = @ExpirationDate, EntryDate = @EntryDate WHERE ItemBarCode = @ItemBarCode
set @Status = 1
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[UpdateItemQuantity]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[UpdateItemQuantity] AS' 
END
GO
ALTER procedure [dbo].[UpdateItemQuantity]
	@ItemBarCode nvarchar(255),
	@ItemQuantity nvarchar(255),
	@Date Date,
	@Status int OUTPUT
AS
BEGIN
    UPDATE Items Set ItemQuantity = @ItemQuantity, Date = @Date WHERE ItemBarCode = @ItemBarCode
set @Status = 1
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[UpdateItemType]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[UpdateItemType] AS' 
END
GO
ALTER procedure [dbo].[UpdateItemType]
	@ItemTypeID int,
	@ItemTypeName nvarchar(255) = NULL,
	@Status int OUTPUT
AS
BEGIN
    UPDATE ItemTypes SET name = @ItemTypeName WHERE id = @ItemTypeID
set @Status = 1
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[UpdateItemWarehouse]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[UpdateItemWarehouse] AS' 
END
GO
ALTER procedure [dbo].[UpdateItemWarehouse]
	@ItemName nvarchar(255),
	@ItemBarCode nvarchar(255),
	@ItemQuantity int,
	@ItemBuyPrice decimal(18, 2),
	@WarehouseID nvarchar(255),
	@EntryExitType int,
	@Date Date,
	@TransactionID int,
	@WarningQuantity int = 0,
	@ProductionDate date = NULL,
	@ExpirationDate date = NULL,
	@EntryDate date = NULL,
	@Status int OUTPUT
AS
BEGIN
	Declare @oldquantity int = (SELECT ItemQuantity FROM Items WHERE ItemBarCode = @ItemBarCode)
	if @EntryExitType = 0
		Set @ItemQuantity = @oldquantity + @ItemQuantity
	else if @EntryExitType = 1
		Set @ItemQuantity = @oldquantity - @ItemQuantity
    UPDATE Items Set ItemName = @ItemName, ItemBarCode = @ItemBarCode, ItemQuantity = @ItemQuantity, ItemBuyPrice = @ItemBuyPrice, Warehouse_id = @WarehouseID, Date = @Date, QuantityWarning = @WarningQuantity, ProductionDate = @ProductionDate, ExpirationDate = @ExpirationDate, EntryDate = @EntryDate WHERE ItemBarCode = @ItemBarCode
	INSERT INTO TransactionItems(item_barcode, item_quantity, transaction_id) VALUES (@ItemBarCode, @ItemQuantity, @TransactionID)
set @Status = 1
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[UpdatePrinter]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[UpdatePrinter] AS' 
END
GO
ALTER procedure [dbo].[UpdatePrinter]
	@PrinterID int,
	@PrinterName nvarchar(255) = NULL,
	@Status int OUTPUT
AS
BEGIN
    UPDATE Printers SET printerName = @PrinterName WHERE id = @PrinterID
set @Status = 1
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[UpdateSystemSettings]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[UpdateSystemSettings] AS' 
END
GO
ALTER procedure [dbo].[UpdateSystemSettings]
@SystemName nvarchar(255),
@SystemLogo varbinary(MAX),
@SystemPhone nvarchar(255),
@SystemAddress nvarchar(255),
@SystemReceiptBlankSpaces int,
@SystemIncludeLogoInReceipt int,
@SystemTax decimal(18, 2),
	@Status int OUTPUT
AS
BEGIN
    UPDATE Settings Set SystemName = @SystemName, SystemLogo = @SystemLogo, SystemPhone = @SystemPhone, SystemAddress = @SystemAddress, SystemReceiptBlankSpaces = @SystemReceiptBlankSpaces,
	SystemIncludeLogoInReceipt = @SystemIncludeLogoInReceipt, SystemTax = @SystemTax WHERE Settings.id = 1
set @Status = 1
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[UpdateUser]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[UpdateUser] AS' 
END
GO
ALTER procedure [dbo].[UpdateUser]
	@UserName nvarchar(255),
	@UserID nvarchar(255),
	@UserPWD nvarchar(255) = NULL,
	@UserAuthority nvarchar(255),
	@ClientCardEditPerm nvarchar(255),
	@discountEditPerm nvarchar(255),
	@priceEditPerm nvarchar(255),
	@receiptEditPerm nvarchar(255),
	@inventoryEditPerm nvarchar(255),
	@expensesEditPerm nvarchar(255),
	@usersEditPerm nvarchar(255),
	@settingsEditPerm nvarchar(255),
	@personnelEditPerm nvarchar(255),
	@opencloseEditPerm nvarchar(255),
	@sellEditPerm nvarchar(255),
	@Status int OUTPUT
AS
BEGIN
	UPDATE Users Set UID = @UserID, PWD = CASE WHEN ISNULL(@UserPWD, '') = '' THEN PWD ELSE @UserPWD END, cashierName = @UserName, Authority = @UserAuthority WHERE UID = @UserID
	DECLARE @UID INT = (SELECT id FROM Users Where UID = @UserID)
	UPDATE UserPermissions SET Client_card_perm = @ClientCardEditPerm, discount_perm = @discountEditPerm, price_edit_perm = @priceEditPerm, receipt_edit_perm = @receiptEditPerm, inventory_edit_perm = @inventoryEditPerm, expense_add_perm = @expensesEditPerm, users_edit_perm = @usersEditPerm, settings_edit_perm = @settingsEditPerm, personnel_edit_perm = @personnelEditPerm, openclose_edit_perm = @opencloseEditPerm, sell_edit_perm = @sellEditPerm WHERE user_id = @UID
set @Status = 1
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[UpdateWarehouse]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[UpdateWarehouse] AS' 
END
GO
ALTER procedure [dbo].[UpdateWarehouse]
	@WarehouseID int,
	@WarehouseName nvarchar(255) = NULL,
	@Status int OUTPUT
AS
BEGIN
    UPDATE Warehouses SET name = @WarehouseName WHERE id = @WarehouseID
set @Status = 1
END
GO
